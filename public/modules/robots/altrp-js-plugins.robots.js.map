{"version":3,"sources":["webpack:///./resources/modules/front-app/src/js/helpers/plugins.js"],"names":["vIOn","document","getElementsByClassName","length","link","body","appendChild","createElement","classList","add","$","bvi","bvi_target","click","remove","loadVIPlugin","init","loadJQuery","querySelector","bVIStyles","head","setAttribute","style","css","styleSheet","cssText","createTextNode","bVIScript","promise","Promise","res","rej","resolve","reject","scriptsLoaded","loadChecker","onload","onerror","jQueryScript"],"mappings":"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","file":"altrp-js-plugins.robots.js","sourcesContent":["/**\r\n * Включаем версию сайта для слабовидящих\r\n */\r\nexport function vIOn(){\r\n  if(document.getElementsByClassName('bvi-body').length){\r\n    return;\r\n  }\r\n  const link = document.body.appendChild(document.createElement('a'));\r\n  link.classList.add('altrp-bvi-open');\r\n  $.bvi({\r\n    bvi_target: '.altrp-bvi-open'\r\n  });\r\n  link.click();\r\n  link.remove();\r\n}\r\n/**\r\n * Загружаем BVI, если не заргужен\r\n * @param {boolean} init - нужно ли включать\r\n * @return {Promise<void>}\r\n */\r\nexport async function loadVIPlugin(init = true){\r\n  await loadJQuery();\r\n\r\n  if(document.querySelector('link[href=\"/plugins/button-visually-impaired-javascript/css/bvi.min.css\"]')\r\n      // && document.querySelector('script[src=\"/plugins/button-visually-impaired-javascript/js/js.cookie.min.js\"]')\r\n      // && document.querySelector('script[src=\"/plugins/button-visually-impaired-javascript/js/bvi-init.min.js\"]')\r\n      && document.querySelector('script[src=\"/plugins/button-visually-impaired-javascript/js/bvi.min.js\"]')\r\n  ){\r\n    init && vIOn();\r\n    return;\r\n  }\r\n\r\n  const bVIStyles = document.head.appendChild(document.createElement('link'));\r\n  bVIStyles.setAttribute('href', '/plugins/button-visually-impaired-javascript/css/bvi.min.css');\r\n  bVIStyles.setAttribute('rel', 'stylesheet');\r\n\r\n  const style = document.head.appendChild(document.createElement('style'));\r\n  style.setAttribute('type', 'text/css');\r\n  // language=CSS\r\n  const css = `\r\n  .bvi-body{\r\n    height: 100%;\r\n  }\r\n  .bvi-link-copy{\r\n    display: none!important;\r\n  }\r\n  .bvi-hide.admin-bar,\r\n  .bvi-hide.altrp-element{\r\n    display: flex;\r\n  }\r\n  `;\r\n  if (style.styleSheet){\r\n    // This is required for IE8 and below.\r\n    style.styleSheet.cssText = css;\r\n  } else {\r\n    style.appendChild(document.createTextNode(css));\r\n  }\r\n\r\n  // const jsCookieScript = document.head.appendChild(document.createElement('script'));\r\n  // jsCookieScript.setAttribute('src', '/plugins/button-visually-impaired-javascript/js/js.cookie.min.js');\r\n\r\n  const bVIScript = document.head.appendChild(document.createElement('script'));\r\n  bVIScript.setAttribute('src', '/plugins/button-visually-impaired-javascript/js/bvi.min.js');\r\n\r\n  // const bVIInitScript = document.head.appendChild(document.createElement('script'));\r\n  // bVIInitScript.setAttribute('src', '/plugins/button-visually-impaired-javascript/js/bvi-init.min.js');\r\n\r\n  let resolve, reject;\r\n  const promise = new Promise((res, rej) => {\r\n    resolve = res;\r\n    reject = rej;\r\n  });\r\n\r\n  \r\n  let scriptsLoaded = 0;\r\n  const loadChecker = ()=>{\r\n    if(++scriptsLoaded < 2){\r\n      return;\r\n    }\r\n    init && vIOn();\r\n    resolve && resolve();\r\n  };\r\n\r\n  bVIStyles.onload = loadChecker;\r\n  // jsCookieScript.onload = loadChecker;\r\n  bVIScript.onload = loadChecker;\r\n\r\n  bVIStyles.onerror = () => {\r\n    reject && reject()\r\n  };\r\n  // jsCookieScript.onerror = () => {\r\n  //   reject && reject()\r\n  // };\r\n  // bVIInitScript.onerror = () => {\r\n  //   reject && reject()\r\n  // };\r\n  bVIScript.onerror = () => {\r\n    reject && reject()\r\n  };\r\n  return promise;\r\n}\r\n\r\n/**\r\n * Загружаем jQuery, если не заргужен\r\n * @return {Promise<void>}\r\n */\r\nexport async function loadJQuery(){\r\n  if(document.querySelector('script[src=\"/plugins/jquery.js\"]')){\r\n    return;\r\n  }\r\n\r\n  const jQueryScript = document.head.appendChild(document.createElement('script'));\r\n  jQueryScript.setAttribute('src', '/plugins/jquery.js');\r\n\r\n  let resolve, reject;\r\n  const promise = new Promise((res, rej) => {\r\n    resolve = res;\r\n    reject = rej;\r\n  });\r\n  jQueryScript.onload = () => {\r\n    resolve && resolve()\r\n  };\r\n  jQueryScript.onerror = () => {\r\n    reject && reject()\r\n  };\r\n\r\n  return promise;\r\n}"],"sourceRoot":""}