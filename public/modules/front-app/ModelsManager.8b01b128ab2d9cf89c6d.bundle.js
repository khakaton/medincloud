(self.webpackChunk=self.webpackChunk||[]).push([[1198],{75098:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return h}});var n=a(6610),s=a(5991),r=a(96156),c=a(92137),o=a(87757),i=a.n(o),u=a(38773);function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}var d=function(){function t(e,a){(0,n.Z)(this,t),this.modelName=e,a||console.error("ид модели не указан!"),this.modelId=a,this.data=null,this.subscribers=[],this.resource=new u.Z({route:"/ajax/models/".concat(this.modelName)}),this.updating=!1}var e;return(0,s.Z)(t,[{key:"subscribeToUpdates",value:function(t){this.subscribers.push(t),this.updating||(this.data&&this.callSubscribers(),this.updateData())}},{key:"updateData",value:(e=(0,c.Z)(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updating=!0,t.next=3,this.resource.get(this.modelId);case 3:this.data=t.sent,this.updating=!1,this.callSubscribers();case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"callSubscribers",value:function(){var t=this;this.subscribers.forEach((function(e){_.isFunction(e.updateModelData)&&e.updateModelData(t.getData()),_.isFunction(e)&&e(t.getData())}))}},{key:"unsubscribe",value:function(t){this.subscribers=this.subscribers.filter((function(e){return e!==t}))}},{key:"getData",value:function(){return this.data}},{key:"updateWithData",value:function(t){this.data=_.extend(this.data,function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(Object(a),!0).forEach((function(e){(0,r.Z)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}({},t)),this.callSubscribers()}}]),t}(),h=new(function(){function t(){(0,n.Z)(this,t),this.modelsStorage={}}return(0,s.Z)(t,[{key:"updateModel",value:function(t,e){this.modelsStorage["".concat(t,"::").concat(e)]||this.modelsStorage["".concat(t,"::").concat(e)].updateData()}},{key:"addModel",value:function(t){}},{key:"getModel",value:function(t,e){}},{key:"subscribeToModelUpdates",value:function(t,e,a){return e?(this.modelsStorage["".concat(t,"::").concat(e)]||(this.modelsStorage["".concat(t,"::").concat(e)]=new d(t,e)),(n=this.modelsStorage["".concat(t,"::").concat(e)]).subscribeToUpdates(a),n):null;var n}},{key:"unsubscribe",value:function(t,e,a){return e?this.modelsStorage["".concat(t,"::").concat(e)]?((n=this.modelsStorage["".concat(t,"::").concat(e)]).unsubscribe(a),n):void 0:null;var n}},{key:"updateModelWithData",value:function(t,e,a){this.modelsStorage["".concat(t,"::").concat(e)]&&this.modelsStorage["".concat(t,"::").concat(e)].updateWithData(a)}}]),t}())}}]);
//# sourceMappingURL=ModelsManager.8b01b128ab2d9cf89c6d.bundle.js.map