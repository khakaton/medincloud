{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./resources/modules/editor/src/js/components/widgets/InputGalleryWidget.js","webpack:///./resources/modules/front-app/src/js/classes/AltrpFile.js","webpack:///./resources/modules/front-app/src/js/store/forms-data-storage/actions.js"],"names":["_assertThisInitialized","self","ReferenceError","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","TypeError","prototype","create","constructor","_possibleConstructorReturn","call","_setPrototypeOf","p","_typeof","Symbol","iterator","CloseIcon","window","altrpHelpers","isEditor","parseOptionsFromSettings","replaceContentWithData","getDataFromLocalStorage","FileInput","altrpLibs","Blueprint","globalDefaults","push","InputGalleryWidget","props","getValue","formId","element","getFormId","fieldName","getFieldId","state","_","get","appStore","getState","onChange","filesStorage","setState","dispatchFieldValueToStore","userInput","indexOf","isObject","dispatch","changeFormFieldValue","change_actions","getSettings","actionsManager","default","callAllWidgetActions","getIdForAction","addElements","e","notActive","files","target","limit","getResponsiveSetting","map","file","idx","AltrpFile","concat","Promise","all","storeFile","getProperty","console","error","slice","Math","random","forEach","reader","FileReader","readAsDataURL","getFile","onload","result","component","elementDecorator","defaultValue","getContent","settings","imageUrls_0","altrpSelectRef","React","item","this","filter","fileToDelete","deleteFileFromStorage","v","prevProps","prevState","options","currentModel","contentLoaded","currentDataStorage","content_options","model_for_options","isEqual","dynamic","updateValue","content_calculation","altrpforms","formsStore","prevContext","altrpdata","getData","altrpmodel","altrpuser","currentUser","altrppagestate","altrpPageState","altrpresponses","altrpmeta","altrpMeta","context","getCurrentModel","currentDataStorageLoaded","changedField","altrpstorage","replace","eval","message","getId","path","inputProps","name","getName","accept","multiple","fileInputProps","style","pointerEvents","backgroundImage","onInputChange","className","length","display","deleteText","title","onClick","deleteItem","Component","data","File","Error","type","setProperty","getResource","postFiles","response","id","delete","getFileName","resource","Resource","route","AltrpModel","CHANGE_FORM_FIELD_VALUE","CLEAR_FORM_FIELD_VALUE"],"mappings":"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","file":"InputGallery.6d19385178704c8d8267.bundle.js","sourcesContent":["export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import AltrpFile from \"../../../../../front-app/src/js/classes/AltrpFile\";\r\nimport CloseIcon from \"../../../svgs/times.svg\"\r\n\r\nconst {\r\n  isEditor,\r\n  parseOptionsFromSettings,\r\n  replaceContentWithData,\r\n  getDataFromLocalStorage\r\n} = window.altrpHelpers;\r\nimport {changeFormFieldValue} from \"../../../../../front-app/src/js/store/forms-data-storage/actions\";\r\n\r\nconst FileInput = window.altrpLibs.Blueprint.FileInput;\r\n\r\n(window.globalDefaults = window.globalDefaults || []).push(`\r\n.altrp-widget_input-gallery .bp3-file-upload-input{\r\n    display: none;\r\n}\r\n.altrp-widget_input-gallery .bp3-file-upload-input::after{\r\n  width: auto;\r\n  min-width: 0;\r\n  display: none;\r\n}\r\n.input-gallery__item.input-gallery__item{\r\n  height: 100px;\r\n}\r\n.input-gallery__item.input-gallery__item.input-gallery__item.input-gallery__item{\r\n  background-repeat: no-repeat;\r\n  background-size: contain;\r\n  background-position: center;\r\n  position: relative;\r\n    width:100%;\r\n}\r\n.input-gallery__item.input-gallery__item svg{\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    cursor: pointer;\r\n}\r\n.input-gallery-wrapper{\r\n    display: grid;\r\n    grid-auto-flow: row dense;\r\n    }\r\n`)\r\n\r\nclass InputGalleryWidget extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    props.element.component = this;\r\n    if (window.elementDecorator) {\r\n      window.elementDecorator(this);\r\n    }\r\n    this.defaultValue = this.getContent(\"content_default_value\") || [];\r\n\r\n    this.state = {\r\n      settings: {...props.element.getSettings()},\r\n      value: this.defaultValue,\r\n      imageUrls_0: _.get(props.element.getResponsiveSetting('preview_placeholder'), 'url'),\r\n    };\r\n    this.altrpSelectRef = React.createRef();\r\n    if (this.getContent(\"content_default_value\")) {\r\n      this.dispatchFieldValueToStore(this.defaultValue);\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param e\r\n   * @param item\r\n   */\r\n  async deleteItem(e, item){\r\n    this.setState(state => ({...state, notActive: true}))\r\n    let filesStorage = this.state.filesStorage;\r\n    let value = this.getValue()\r\n    let fileToDelete;\r\n    filesStorage = filesStorage.filter(file => {\r\n      if(file.getProperty('media.id') === item){\r\n        fileToDelete = file;\r\n      }\r\n      return file.getProperty('media.id') !== item\r\n      })\r\n\r\n    if(fileToDelete){\r\n      try {\r\n        await fileToDelete.deleteFileFromStorage()\r\n      } catch (e) {console.error(e);}\r\n    }\r\n    value = value.filter(v => v !== item)\r\n    try {\r\n      const limit = this.props.element.getResponsiveSetting('limit');\r\n      _.forEach(filesStorage, (file, idx) => {\r\n        if (limit && idx >= limit) {\r\n          return\r\n        }\r\n        const reader = new FileReader\r\n        reader.readAsDataURL(file.getFile())\r\n        reader.onload = async () => {\r\n          this.setState(state => {\r\n              state[`imageUrls_${idx}`] = reader.result;\r\n              return {...state};\r\n            }\r\n          )\r\n\r\n        }\r\n      })\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    this.setState(state => ({...state, notActive: false}))\r\n    this.onChange(value, filesStorage)\r\n  }\r\n\r\n  /**\r\n   * Чистит значение\r\n   */\r\n  clearValue() {\r\n    this.onChange([]);\r\n    this.dispatchFieldValueToStore(null, true);\r\n  }\r\n\r\n\r\n  /**\r\n   *\r\n   * @returns {[]}\r\n   */\r\n  getValue = () => {\r\n    let value;\r\n    let formId = this.props.element.getFormId();\r\n    let fieldName = this.props.element.getFieldId();\r\n    if (isEditor()) {\r\n      value = this.state.value;\r\n    } else {\r\n      value = _.get(appStore.getState(), `formsStore.${formId}.${fieldName}`, '')\r\n    }\r\n    return value || [];\r\n  }\r\n\r\n  /**\r\n   * Загрузка виджета\r\n   * @param {{}} prevProps\r\n   * @param {{}} prevState\r\n   */\r\n  async _componentDidMount(prevProps, prevState) {\r\n    if (this.props.element.getSettings(\"content_options\")) {\r\n      let options = parseOptionsFromSettings(\r\n        this.props.element.getSettings(\"content_options\")\r\n      );\r\n\r\n      this.setState(state => ({...state, options}));\r\n    }\r\n\r\n    let value = this.state.value;\r\n\r\n    /**\r\n     * Если динамическое значение загрузилось,\r\n     * то используем this.getContent для получение этого динамического значения\r\n     * старые динамические данные\r\n     * */\r\n    if (\r\n      _.get(value, \"dynamic\") &&\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\")\r\n    ) {\r\n      value = this.getContent(\"content_default_value\") || [];\r\n    }\r\n\r\n    /**\r\n     * Если модель обновилась при смене URL\r\n     */\r\n    if (\r\n      prevProps &&\r\n      !prevProps.currentModel.getProperty(\"altrpModelUpdated\") &&\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\")\r\n    ) {\r\n      value = this.getContent(\"content_default_value\") || [];\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\") &&\r\n      this.props.currentDataStorage.getProperty(\"currentDataStorageLoaded\") &&\r\n      !this.state.contentLoaded\r\n    ) {\r\n      value = this.getContent(\"content_default_value\") || [];\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (this.state.value !== value) {\r\n      this.setState(\r\n        state => ({...state, value}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Обновление виджета\r\n   */\r\n  async _componentDidUpdate(prevProps, prevState) {\r\n    const {content_options, model_for_options} = this.state.settings;\r\n    if (!this.getValue() && this.state.imageUrls_0 !== _.get(this.props.element.getResponsiveSetting('preview_placeholder'), 'url')) {\r\n      this.setState(\r\n        state => ({...state, imageUrls_0: _.get(this.props.element.getResponsiveSetting('preview_placeholder'), 'url')})\r\n      )\r\n    }\r\n    if (\r\n      prevProps &&\r\n      !prevProps.currentDataStorage.getProperty(\"currentDataStorageLoaded\") &&\r\n      this.props.currentDataStorage.getProperty(\"currentDataStorageLoaded\")\r\n    ) {\r\n      let value = this.getContent(\r\n        \"content_default_value\",\r\n        this.props.element.getSettings(\"select2_multiple\")\r\n      );\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Если обновилась модель, то пробрасываем в стор новое значение (старый источник диамических данных)\r\n     */\r\n    if (\r\n      !_.isEqual(this.props.currentModel, prevProps.currentModel) &&\r\n      this.state.value &&\r\n      this.state.value.dynamic\r\n    ) {\r\n      this.dispatchFieldValueToStore(this.getContent(\"content_default_value\") || []);\r\n    }\r\n\r\n    if (content_options && !model_for_options) {\r\n      let options = parseOptionsFromSettings(content_options);\r\n      if (!_.isEqual(options, this.state.options)) {\r\n        this.setState(state => ({...state, options}));\r\n      }\r\n    }\r\n    this.updateValue(prevProps);\r\n  }\r\n\r\n  /**\r\n   * Обновить значение если нужно\r\n   * @param {{}} prevProps\r\n   */\r\n  updateValue(prevProps) {\r\n\r\n    if (isEditor()) {\r\n      return;\r\n    }\r\n\r\n    let content_calculation = this.props.element.getSettings(\r\n      \"content_calculation\"\r\n    );\r\n    const altrpforms = this.props.formsStore;\r\n    const fieldName = this.props.element.getFieldId();\r\n    const formId = this.props.element.getFormId();\r\n\r\n    if (!content_calculation) {\r\n      /**\r\n       * Обновить значение, если formsStore изменилось из другого компонента\r\n       */\r\n      const path = `${formId}.${fieldName}`;\r\n      if (\r\n        this.props.formsStore !== prevProps.formsStore &&\r\n        _.get(altrpforms, path) !== this.state.value\r\n      ) {\r\n        this.setState(state => ({\r\n          ...state,\r\n          value: _.get(altrpforms, path)\r\n        }));\r\n      }\r\n      return;\r\n    }\r\n\r\n    const prevContext = {};\r\n    const altrpdata = this.props.currentDataStorage.getData();\r\n    const altrpmodel = this.props.currentModel.getData();\r\n    const altrpuser = this.props.currentUser.getData();\r\n    const altrppagestate = this.props.altrpPageState.getData();\r\n    const altrpresponses = this.props.altrpresponses.getData();\r\n    const altrpmeta = this.props.altrpMeta.getData();\r\n    const context = this.props.element.getCurrentModel().getData();\r\n\r\n    if (content_calculation.indexOf(\"altrpdata\") !== -1) {\r\n      context.altrpdata = altrpdata;\r\n      if (!altrpdata.currentDataStorageLoaded) {\r\n        prevContext.altrpdata = altrpdata;\r\n      } else {\r\n        prevContext.altrpdata = prevProps.currentDataStorage.getData();\r\n      }\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpforms\") !== -1) {\r\n      context.altrpforms = altrpforms;\r\n      /**\r\n       * Не производим вычисления, если изменилось текущее поле\r\n       */\r\n      if (`${formId}.${fieldName}` === altrpforms.changedField) {\r\n        prevContext.altrpforms = altrpforms;\r\n      } else {\r\n        prevContext.altrpforms = prevProps.formsStore;\r\n      }\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpmodel\") !== -1) {\r\n      context.altrpmodel = altrpmodel;\r\n      prevContext.altrpmodel = prevProps.currentModel.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpuser\") !== -1) {\r\n      context.altrpuser = altrpuser;\r\n      prevContext.altrpuser = prevProps.currentUser.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpuser\") !== -1) {\r\n      context.altrpuser = altrpuser;\r\n      prevContext.altrpuser = prevProps.currentUser.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrppagestate\") !== -1) {\r\n      context.altrppagestate = altrppagestate;\r\n      prevContext.altrppagestate = prevProps.altrpPageState.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpmeta\") !== -1) {\r\n      context.altrpmeta = altrpmeta;\r\n      prevContext.altrpmeta = prevProps.altrpMeta.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpresponses\") !== -1) {\r\n      context.altrpresponses = altrpresponses;\r\n      prevContext.altrpresponses = prevProps.altrpresponses.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpstorage\") !== -1) {\r\n      context.altrpstorage = getDataFromLocalStorage(\"altrpstorage\", {});\r\n    }\r\n\r\n    if (\r\n      _.isEqual(prevProps.currentDataStorage, this.props.currentDataStorage) &&\r\n      _.isEqual(prevProps.currentUser, this.props.currentUser) &&\r\n      _.isEqual(prevProps.formsStore, this.props.formsStore) &&\r\n      _.isEqual(prevProps.altrpPageState, this.props.altrpPageState) &&\r\n      _.isEqual(prevProps.altrpMeta, this.props.altrpMeta) &&\r\n      _.isEqual(prevProps.altrpresponses, this.props.altrpresponses) &&\r\n      _.isEqual(prevProps.currentModel, this.props.currentModel)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !_.isEqual(prevProps.formsStore, this.props.formsStore) &&\r\n      `${formId}.${fieldName}` === altrpforms.changedField\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    let value = \"\";\r\n\r\n    try {\r\n      content_calculation = content_calculation\r\n        .replace(/}}/g, \"')\")\r\n        .replace(/{{/g, \"_.get(context, '\");\r\n      value = eval(content_calculation);\r\n      if (value === this.state.value) {\r\n        return;\r\n      }\r\n      this.setState(\r\n        state => ({...state, value}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    } catch (e) {\r\n      console.error(\r\n        \"Evaluate error in Input \" + e.message,\r\n        this.props.element.getId()\r\n      );\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Изменение значения в виджете\r\n   * @param {[]} value\r\n   * @param {[]| null} filesStorage\r\n   */\r\n  onChange = async (value, filesStorage = null) => {\r\n    this.setState(state => ({...state, filesStorage}))\r\n    if (isEditor()) {\r\n      this.setState(state => ({...state, value}))\r\n    } else {\r\n      this.dispatchFieldValueToStore(value, true)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Передадим значение в хранилище формы\r\n   * @param {*} value\r\n   * @param {boolean} userInput true - имзенилось пользователем\r\n   */\r\n  dispatchFieldValueToStore = async (value, userInput = false) => {\r\n    let formId = this.props.element.getFormId();\r\n    let fieldName = this.props.element.getFieldId();\r\n\r\n    if (fieldName.indexOf(\"{{\") !== -1) {\r\n      fieldName = replaceContentWithData(fieldName);\r\n    }\r\n    if (_.isObject(this.props.appStore) && fieldName && formId) {\r\n      this.props.appStore.dispatch(\r\n        changeFormFieldValue(fieldName, value, formId, userInput)\r\n      );\r\n\r\n      if (userInput) {\r\n        const change_actions = this.props.element.getSettings(\"change_actions\");\r\n\r\n        if (change_actions && !isEditor()) {\r\n          const actionsManager = (\r\n            await import(\r\n              /* webpackChunkName: 'ActionsManager' */\r\n              \"../../../../../front-app/src/js/classes/modules/ActionsManager.js\"\r\n              )\r\n          ).default;\r\n          await actionsManager.callAllWidgetActions(\r\n            this.props.element.getIdForAction(),\r\n            \"change\",\r\n            change_actions,\r\n            this.props.element\r\n          );\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  addElements = async (e) => {\r\n    this.setState(state => ({...state, notActive: true}))\r\n    let {filesStorage} = this.state;\r\n    filesStorage = filesStorage || []\r\n    let files = e.target.files;\r\n    const limit = this.props.element.getResponsiveSetting('limit');\r\n    let value = this.getValue();\r\n\r\n    files = _.map(files, (file, idx) => {\r\n      return new AltrpFile(file)\r\n    })\r\n    filesStorage = filesStorage.concat(files)\r\n    this.setState(state => ({...state, filesStorage: value}))\r\n    try {\r\n      value = value.concat(\r\n        await Promise.all(\r\n          files.map(async file => ((await file.storeFile()).getProperty('media.id')))\r\n        )\r\n      )\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n\r\n    if (limit) {\r\n      value = value.slice(0, limit)\r\n      filesStorage = filesStorage.slice(0, limit)\r\n    }\r\n    this.onChange(value, filesStorage)\r\n    this.setState(state => ({...state, key: Math.random()}))\r\n    try {\r\n      _.forEach(filesStorage, (file, idx) => {\r\n        if (limit && idx >= limit) {\r\n          return\r\n        }\r\n        const reader = new FileReader\r\n        reader.readAsDataURL(file.getFile())\r\n        reader.onload = () => {\r\n          this.setState(state => {\r\n              state[`imageUrls_${idx}`] = reader.result;\r\n              return {...state};\r\n            }\r\n          )\r\n        }\r\n      })\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    this.setState(state => ({...state, notActive: false}))\r\n  }\r\n\r\n  /**\r\n   * Взовращает имя для атрибута name\r\n   * @return {string}\r\n   */\r\n  getName() {\r\n    return `${this.props.element.getFormId()}[${this.props.element.getFieldId()}]`;\r\n  }\r\n\r\n  render() {\r\n    const {element} = this.props\r\n\r\n    const inputProps = {\r\n      name: this.getName(),\r\n      accept: element.getResponsiveSetting('accept'),\r\n      multiple: 1,\r\n    }\r\n    const {notActive} = this.state\r\n    const value = this.getValue()\r\n    const limit = element.getResponsiveSetting('limit')\r\n    const fileInputProps = {\r\n      key: this.state.key,\r\n      inputProps,\r\n      style: {\r\n        pointerEvents: notActive ? 'none' : '',\r\n        backgroundImage: `url(${element.getResponsiveSetting('placeholder') || \"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDY0IDY0IiB3aWR0aD0iMTAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGNsYXNzPSJpY29uIj48cGF0aCBkPSJNMjMuNDE0IDIxLjQxNEwzMCAxNC44MjhWNDRhMiAyIDAgMDA0IDBWMTQuODI4bDYuNTg2IDYuNTg2Yy4zOS4zOTEuOTAyLjU4NiAxLjQxNC41ODZzMS4wMjQtLjE5NSAxLjQxNC0uNTg2YTIgMiAwIDAwMC0yLjgyOGwtMTAtMTBhMiAyIDAgMDAtMi44MjggMGwtMTAgMTBhMiAyIDAgMTAyLjgyOCAyLjgyOHoiPjwvcGF0aD48cGF0aCBkPSJNNTAgNDBhMiAyIDAgMDAtMiAydjhjMCAxLjEwMy0uODk3IDItMiAySDE4Yy0xLjEwMyAwLTItLjg5Ny0yLTJ2LThhMiAyIDAgMDAtNCAwdjhjMCAzLjMwOSAyLjY5MSA2IDYgNmgyOGMzLjMwOSAwIDYtMi42OTEgNi02di04YTIgMiAwIDAwLTItMnoiPjwvcGF0aD48L3N2Zz4K\"})`\r\n      },\r\n      onInputChange: this.addElements,\r\n      className: `bp3-file-input_preview input-gallery__item`,\r\n    }\r\n    if (limit && value.length >= limit) {\r\n      fileInputProps.style.display = 'none'\r\n    }\r\n    const deleteText = element.getResponsiveSetting('delete', '')\r\n    return (\r\n      <div className=\"input-gallery-wrapper\">\r\n        {value.map((item, idx) => {\r\n          return <div\r\n            className=\"input-gallery__item\"\r\n            title={deleteText}\r\n            style={{\r\n              backgroundImage: `url(${this.state[`imageUrls_${idx}`]})`\r\n            }}\r\n            key={item}>\r\n            {<CloseIcon className=\"input-gallery__delete\" onClick={(e) => {\r\n              this.deleteItem(e, item)\r\n            }}/>}\r\n          </div>\r\n        })}\r\n        <FileInput {...fileInputProps} />\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nexport default InputGalleryWidget;\r\n","/**\r\n * @class AltrpFile\r\n */\r\nclass AltrpFile extends AltrpModel{\r\n  constructor(data) {\r\n    if(data instanceof File){\r\n      data = {file: data}\r\n    }\r\n    if(! data.file instanceof File){\r\n      throw new Error('Need a File instance in AltrpFile Constructor')\r\n    }\r\n    super(data);\r\n    if(data.file.type.indexOf('image') >= 0){\r\n      const reader = new FileReader\r\n      reader.onload = ()=>{\r\n        this.setProperty('dataAsUrl', reader.result)\r\n      }\r\n      reader.readAsDataURL(data.file)\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {Promise<AltrpFile>}\r\n   */\r\n  async storeFile(){\r\n    try {\r\n      let response = await AltrpFile.getResource().postFiles([this.getFile()])\r\n      this.setProperty('media', response[0])\r\n    }catch (e) {\r\n      console.error(e);\r\n    }\r\n    return this\r\n  }\r\n  /**\r\n   *\r\n   * @returns {Promise<AltrpFile>}\r\n   */\r\n  async deleteFileFromStorage(){\r\n    const id = this.getProperty('media.id');\r\n    if(! id){\r\n      return this\r\n    }\r\n    try {\r\n      let response = await AltrpFile.getResource().delete(id)\r\n      this.setProperty('media', null)\r\n    }catch (e) {\r\n      console.error(e);\r\n    }\r\n    return this\r\n  }\r\n\r\n  /**\r\n   * @return {File}\r\n   */\r\n  getFile(){\r\n    return this.getProperty('file')\r\n  }\r\n  getFileName(){\r\n    return this.getFile()?.name || ''\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {string}\r\n   */\r\n  toString(){\r\n    return this.getFileName()\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {Resource}\r\n   */\r\n  static getResource(){\r\n    if(! AltrpFile.resource){\r\n      AltrpFile.resource = new window.altrpHelpers.Resource({route: '/ajax/media'})\r\n    }\r\n    return AltrpFile.resource\r\n  }\r\n}\r\n\r\nexport default AltrpFile\r\n","export const CHANGE_FORM_FIELD_VALUE = 'CHANGE_FORM_FIELD_VALUE';\nexport const CLEAR_FORM_FIELD_VALUE = 'CHANGE_FORM_FIELD_VALUE';\n\n/**\n * Получает данные поля формы и сохраняет в хранилище\n * @param {string}fieldName\n * @param {*}value\n * @param {string}formId\n * @param {boolean}userInput\n * @return {{type: string, fieldName: *, value: *, formId: *}}\n */\nexport function changeFormFieldValue(fieldName, value, formId, userInput) {\n  return {\n    type: CHANGE_FORM_FIELD_VALUE,\n    fieldName,\n    value,\n    formId,\n    changedField: userInput ? `${formId}.${fieldName}` : null,\n  };\n}\n/**\n * Очистить данные поля формы и сохраняет в хранилище\n * @param {string | null}formId\n * @return {{type: string, fieldName: *, value: *, formId: *}}\n */\nexport function clearFormStorage(formId = null) {\n  return {\n    type: CLEAR_FORM_FIELD_VALUE,\n    formId,\n  };\n}\n\n"],"sourceRoot":""}