{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./resources/modules/editor/src/js/classes/AltrpModel.js","webpack:///./resources/modules/front-app/src/js/helpers.js","webpack:///./resources/modules/front-app/src/js/store/altrp-page-state-storage/actions.js","webpack:///./resources/modules/front-app/src/js/store/current-user/actions.js","webpack:///./resources/modules/front-app/src/js/store/responses-storage/actions.js"],"names":["_setPrototypeOf","o","p","Object","setPrototypeOf","__proto__","AltrpModel","data","this","cloneDeep","clone","isEmpty","name","defaultValue","get","has","value","getData","set","unset","window","defaultTitle","getRoutes","isSSR","SSR","e","iconsManager","setTitle","title","titleElement","document","innerHTML","isEditor","path","location","pathname","includes","parseOptionsFromSettings","string","options","split","_optionsFromData","getDataByPath","extractPathFromString","_","isArray","map","option","valuePath","trim","label","isString","labelPath","getMediaQueryByName","screenSettingName","mediaQuery","CONSTANTS","screen","getMediaSettingsByName","_screen","getCurrentBreakpoint","currentWidth","getWindowWidth","item","size","Number","width","breakpoint","parseURLTemplate","URLTemplate","object","url","protocol","assign","currentRouterMatch","getProperty","indexOf","replaceContentWithData","replace","idTemplates","match","forEach","idTemplate","RegExp","getElementById","offsetWidth","renderAssetIcon","asset","props","type","assetType","renderIcon","React","createElement","src","renderAsset","dataUrl","rawSVG","File","refImg","createRef","fr","FileReader","readAsDataURL","onload","current","result","alt","ref","style","backgroundImage","undefined","parseParamsFromString","context","allowObject","replaceRight","params","urlParams","lines","line","left","right","isObject","conditionsChecker","conditions","AND","model","dataByPath","length","each","c","conditionChecker","operator","modelField","altrpCompare","setDataByPath","dispatch","oldValue","appStore","getState","altrpPageState","isEqual","isFunction","changePageState","altrpMeta","changeAltrpMeta","currentUser","changeCurrentUserProperty","formId","fieldName","formsStore","changeFormFieldValue","pathElements","elementId","updateType","propName","component","getComponentByElementId","join","element","updateSetting","settings","mutate","addSettings","getId","getName","areaName","area","page_areas","find","id","Area","setSetting","currentStorage","getDataFromLocalStorage","saveDataToLocalStorage","trueValue","falseValue","_default","altrpCheck","_path","_right","currentModel","currentDataStorage","altrpresponses","altrpPage","queryData","queryString","href","query","getTimeValue","getSettings","getSetting","getObjectByPrefix","prefix","key","mbParseJSON","JSON","parse","leftValue","rightValue","CONDITIONS_OPTIONS","isElementTopInViewport","top","scrollTop","clientHeight","getTopPosition","offsetTop","offsetParent","now","startOfMonth","Date","startOfYear","getPrevWeekStart","getNextWeekStart","getWeekStart","moment","altrpHelpers","format","date","monthShift","getFullYear","getMonth","yearShift","startOfWeek","weekShift","getDate","firstDayOfWeek","getCurrentStoreState","scrollToElement","scrollbars","container","HTMLElement","scroll","getOffsetTopInElement","parent","getHTMLElementById","elements","el","elementWrapperRef","toString","getWrapperHTMLElementByElement","today","daystoMonday","isoWeekday","add","subtract","daystoLastMonday","clearEmptyProps","content","modelContext","paths","escapeRegExp","printElements","myWindow","open","write","headContent","bodyContent","HTMLHeadElement","outerHTML","close","head","body","focus","delay","then","print","elementsToPdf","filename","html2pdf","default","success","Promise","resolve","reject","from","save","dataFromTable","headers","querySelectorAll","table","querySelector","ths","th","push","innerText","rows","row","cells","part","header","idx","dataToCSV","toPairs","csvContent","h","stringify","blob","Blob","charset","link","setAttribute","URL","createObjectURL","appendChild","click","removeChild","dataToXLS","templateName","formData","FormData","append","fetch","method","response","dataToXML","altrpLogin","Resource","route","post","res","status","__status","addResponseData","_token","getAll","changeCurrentUser","routes","routesData","pages","_data","Route","changeAppRoutes","console","error","altrpLogout","cutString","maxLength","slice","sortOptions","sortDirection","sort","a","b","toLowerCase","reverse","recurseCount","count","array","getAppContext","currentModelData","setProperty","storeWidgetState","widgetId","state","getWidgetState","localStorage","setItem","getItem","scrollbarWidth","scrollDiv","clientWidth","setAltrpIndex","altrpIndex","renderFontLink","font","altrpFontsSet","GOOGLE_FONT","fontUrl","encodeURI","rel","isAltrpTestMode","altrpRandomId","Math","random","substr","generateButtonsArray","pageIndex","pageCount","first_last_buttons_count","middle_buttons_count","buttonsSum","lastButtons","Array","i","middleButtons","floor","keys","isValueMatchMask","mask","every","char","index","getConverter","data_type","ArrayConverter","DataConverter","convertData","converter","isHidden","icon","defaultIcon","className","redirect","linkSettings","frontAppRouter","history","goBack","back","preventDefault","stopPropagation","openInNew","tag","validateEmail","email","test","String","getResponsiveSetting","settingName","elementState","currentScreen","_settingName","setting","suffix","valueReplacement","ms","setTimeout","prepareURLForEmail","origin","parseIDFromYoutubeURL","youtubeURL","startIndex","endIndex","substring","prepareContext","altrpdata","altrpmodel","altrpuser","altrppagestate","altrpmeta","isJSON","JSONString","parseStringValue","getBreadcrumbsItems","breadcrumbsItems","items","currentId","page_id","currentPageId","appRoutes","breadcrumbsClone","idCurrent","parent_page_id","getParent","parentId","altrphelpers","sumFields","sum","CHANGE_PAGE_STATE","CLEAR_PAGE_STATE","stateName","stateValue","CHANGE_CURRENT_USER","SET_NOTICE_FOR_USER","SET_USERS_ONLINE","CHANGE_CURRENT_USER_PROPERTY","user","ADD_RESPONSE_DATA","CLEAR_ALL_RESPONSE_DATA"],"mappings":"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","file":"5739.6f8c79539960c4610611.bundle.js","sourcesContent":["export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","/**\r\n * Имеет интерфейс для доступы к свойствам data (любой вложенности)\r\n * @class AltrpModel\r\n */\r\nimport cloneDeep from 'lodash.clonedeep';\r\nimport get from 'lodash.get';\r\nimport set from 'lodash.set';\r\nimport has from 'lodash.has';\r\nimport unset from 'lodash.unset';\r\nimport isEmpty from 'lodash.isempty';\r\n// import {cloneDeep, get, set, has, unset, isString, isEmpty} from \"lodash\";\r\n\r\nclass AltrpModel {\r\n  constructor(data = {}) {\r\n    this.data = cloneDeep(data);\r\n  }\r\n\r\n  /**\r\n   * Возваращает объект данных\r\n   * @params {boolean} clone - клонировать или ссылку на данные\r\n   * @return {{}}\r\n   */\r\n  getData(clone = true) {\r\n    if(clone){\r\n      return cloneDeep(this.data);\r\n    }\r\n    return this.data;\r\n  }\r\n\r\n  /**\r\n   * Пустой ли объект\r\n   */\r\n  isEmpty(){\r\n    return isEmpty(this.data);\r\n  }\r\n  /**\r\n   * Возврашает значение свойства name\r\n   * @params {string} name\r\n   * @params {*} defaultValue\r\n   * @return {*}\r\n   */\r\n  getProperty(name, defaultValue = '') {\r\n    return get(this.data, name, defaultValue);\r\n  }\r\n  /**\r\n   * Возврашает значение свойства name\r\n   * @params {string} name\r\n   * @params {*} defaultValue\r\n   * @return {*}\r\n   */\r\n  hasProperty(name, defaultValue = '') {\r\n    return has(this.data, name);\r\n  }\r\n  /**\r\n   * Возврашает значение свойства name\r\n   * @params {string} name\r\n   * @params {*} defaultValue\r\n   * @return {{}}\r\n   */\r\n  setProperty(name, value = '') {\r\n    if(value instanceof AltrpModel){\r\n      value = value.getData(false);\r\n    }\r\n    return set(this.data, name, value);\r\n  }\r\n  /**\r\n   * Удаляет свойства name\r\n   * @params {string} name\r\n   * @return {*}\r\n   */\r\n  unsetProperty(name) {\r\n    return unset(this.data, name);\r\n  }\r\n}\r\nwindow.AltrpModel = AltrpModel;\r\nexport default AltrpModel\r\n","import CONSTANTS from \"../../../editor/src/js/consts\";\r\nimport AltrpModel from \"../../../editor/src/js/classes/AltrpModel\";\r\nimport Resource from \"../../../editor/src/js/classes/Resource\";\r\nimport { changeCurrentUser } from \"./store/current-user/actions\";\r\nimport { changeCurrentUserProperty } from \"./store/current-user/actions\";\r\nimport { changeAppRoutes } from \"./store/routes/actions\";\r\nimport Route from \"./classes/Route\";\r\nimport { changePageState } from \"./store/altrp-page-state-storage/actions\";\r\nimport { changeAltrpMeta } from \"./store/altrp-meta-storage/actions\";\r\nimport queryString from \"query-string\";\r\nimport AltrpSVG from \"../../../editor/src/js/components/altrp-svg/AltrpSVG\";\r\nimport ArrayConverter from \"./classes/converters/ArrayConverter\";\r\nimport DataConverter from \"./classes/converters/DataConverter\";\r\nimport { changeFormFieldValue } from \"./store/forms-data-storage/actions\";\r\nimport { addResponseData } from \"./store/responses-storage/actions\";\r\nimport {getOffsetTopInElement} from \"./helpers/elements\";\r\nimport Area from \"./classes/Area\";\r\nimport {altrpFontsSet, GOOGLE_FONT} from \"./constants/fonts\";\r\nimport {addSettings} from \"./store/elements-settings/actions\";\r\nimport mutate from \"dot-prop-immutable\";\r\nexport function getRoutes() {\r\n\r\n  return import(/* webpackChunkName: 'Routes' */\"./classes/Routes.js\");\r\n}\r\n\r\nexport function isSSR(){\r\n  try {\r\n    return window.SSR;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n/**\r\n * @return {IconsManager}\r\n * */\r\nexport function iconsManager() {\r\n  return window.iconsManager;\r\n}\r\n\r\n/**\r\n * Устанавливает заголовок страницы на фронтенде\r\n * @param {string} title\r\n */\r\nexport function setTitle(title) {\r\n  let titleElement = document.title;\r\n  if (!defaultTitle) {\r\n    defaultTitle = titleElement.innerHTML;\r\n  }\r\n  if (!title) {\r\n    title = defaultTitle;\r\n  }\r\n  if (document.title !== title) {\r\n    document.title = title;\r\n  }\r\n}\r\n\r\n/**\r\n * @return {boolean}\r\n * */\r\nexport function isEditor() {\r\n  const path = window.location?.pathname;\r\n  return path?.includes(\"/admin/editor\") || false;\r\n}\r\n\r\n/**\r\n * Переменная, в которой храниться изначальный заголовок\r\n * @let {string}\r\n */\r\nlet defaultTitle;\r\n\r\n/**\r\n * Парсит стрку вводимую пользователем для опций селекта\r\n * @param string\r\n */\r\nexport function parseOptionsFromSettings(string) {\r\n  if (!string) {\r\n    return [];\r\n  }\r\n  let options = string.split(\"\\n\");\r\n  let path = extractPathFromString(string);\r\n  let _optionsFromData = getDataByPath(path);\r\n  if (_.isArray(_optionsFromData)) {\r\n    return _optionsFromData;\r\n  }\r\n  options = options.map(option => {\r\n    let value = option.split(\"|\")[0];\r\n    value = value.trim();\r\n    let valuePath = extractPathFromString(value);\r\n    if (valuePath) {\r\n      value = getDataByPath(valuePath);\r\n    }\r\n    let label = option.split(\"|\")[1] || value || \"\";\r\n    !_.isString(label) && (label = \"\");\r\n    label = label.trim();\r\n    let labelPath = extractPathFromString(label);\r\n    if (labelPath) {\r\n      label = getDataByPath(labelPath);\r\n    }\r\n    return {\r\n      value,\r\n      label\r\n    };\r\n  });\r\n  return options;\r\n}\r\n\r\n/**\r\n * Получает медиа запрос для css по имени настройки\r\n * @param {string} screenSettingName\r\n * @return {string}\r\n */\r\nexport function getMediaQueryByName(screenSettingName) {\r\n  let mediaQuery = \"\";\r\n  CONSTANTS.SCREENS.forEach(screen => {\r\n    if (screen.name === screenSettingName) {\r\n      mediaQuery = screen.mediaQuery;\r\n    }\r\n  });\r\n  return mediaQuery;\r\n}\r\n/**\r\n * Получает медиа запрос для css по имени настройки\r\n * @param {string} screenSettingName\r\n * @return {string}\r\n */\r\nexport function getMediaSettingsByName(screenSettingName) {\r\n  let screen = CONSTANTS.SCREENS[0];\r\n  CONSTANTS.SCREENS.forEach(_screen => {\r\n    if (_screen.name === screenSettingName) {\r\n      screen = _screen;\r\n    }\r\n  });\r\n  return screen;\r\n}\r\n\r\n/**\r\n * Возвращает брейкпоинт относительно текущего размера экрана\r\n */\r\nexport function getCurrentBreakpoint() {\r\n  const currentWidth = getWindowWidth();\r\n  const breakPoints = CONSTANTS.SCREENS;\r\n  const breakPointsSizes = breakPoints.map(item => ({\r\n    name: item.name,\r\n    size: Number(item.width.split(\"px\")[0])\r\n  }));\r\n  for (let breakpoint of breakPointsSizes) {\r\n    if (breakpoint.size < currentWidth) {\r\n      return breakpoint.name;\r\n    }\r\n  }\r\n}\r\n/**\r\n *@param {string} URLTemplate\r\n *@param {{} | null} object\r\n */\r\nexport function parseURLTemplate(URLTemplate = \"\", object = null) {\r\n  let url = URLTemplate;\r\n  let protocol = \"\";\r\n  if (!isEditor()) {\r\n    object = _.assign(\r\n      _.cloneDeep(currentRouterMatch.getProperty(\"params\")),\r\n      object\r\n    );\r\n  }\r\n  url = url.trim();\r\n  if (url.indexOf(\"{{\") !== -1) {\r\n    url = replaceContentWithData(url, object);\r\n  }\r\n  if (url.indexOf(\"https://\") === 0) {\r\n    protocol = \"https://\";\r\n    url = url.replace(\"https://\", \"\");\r\n  }\r\n  if (url.indexOf(\"http://\") === 0) {\r\n    protocol = \"http://\";\r\n    url = url.replace(\"http://\", \"\");\r\n  }\r\n  if (url.indexOf(\"mailto:\") === 0) {\r\n    protocol = \"mailto:\";\r\n    url = url.replace(\"mailto:\", \"\");\r\n  }\r\n  if (url.indexOf(\"tel:\") === 0) {\r\n    protocol = \"tel:\";\r\n    url = url.replace(\"tel:\", \"\");\r\n  }\r\n  // columnEditUrl = columnEditUrl.replace(':id', row.original.id);\r\n  let idTemplates = url.match(/:([\\s\\S]+?)(\\/|$)/g);\r\n  if (!idTemplates) {\r\n    return protocol + url;\r\n  }\r\n  idTemplates.forEach(idTemplate => {\r\n    let replace = object[idTemplate.replace(/:|\\//g, \"\")] || \"\";\r\n    idTemplate = idTemplate.replace(\"/\", \"\");\r\n    url = url.replace(new RegExp(idTemplate, \"g\"), replace);\r\n  });\r\n  return protocol + url;\r\n}\r\n\r\nexport function getWindowWidth() {\r\n  let window;\r\n  if (isEditor()) {\r\n    window = document.getElementById(\"editorWindow\").offsetWidth;\r\n  } else {\r\n    window = document.getElementById(\"front-app\").offsetWidth;\r\n  }\r\n  return window;\r\n}\r\n\r\nexport function renderAssetIcon(asset, props = null) {\r\n  if (asset) {\r\n    if (asset.url && asset.type === \"svg\") {\r\n      return <AltrpSVG {...props} url={asset.url} />;\r\n    }\r\n    switch (asset.assetType) {\r\n      case \"icon\": {\r\n        return iconsManager().renderIcon(asset.name);\r\n      }\r\n      case \"image\": {\r\n        return React.createElement(\"img\", { ...props, src: asset.url });\r\n      }\r\n      case \"media\": {\r\n        return React.createElement(\"img\", { ...props, src: asset.url });\r\n      }\r\n    }\r\n  }\r\n  return \"\";\r\n}\r\n\r\n/**\r\n * @param {object} asset\r\n * @param {object} props\r\n * @return {React.DetailedReactHTMLElement<React.InputHTMLAttributes<HTMLInputElement>, HTMLInputElement> | React.DetailedReactHTMLElement<React.HTMLAttributes<T>, HTMLElement> | React.ReactSVGElement | React.DOMElement<React.DOMAttributes<T>, Element> | React.FunctionComponentElement<{}> | React.CElement<{}, React.ClassicComponent<{}, React.ComponentState>> | React.CElement<{}, React.Component<P, React.ComponentState>> | React.ReactElement<{}> | string}\r\n * @throws Исключение если иконка не найдена\r\n * */\r\nexport function renderAsset(asset, props = null) {\r\n  if(_.isEmpty(asset)){\r\n    return  ''\r\n  }\r\n  if(asset.type === 'image' && asset.dataUrl){\r\n    return React.createElement(\"img\", {\r\n      ...props,\r\n      src: asset.dataUrl,\r\n    });\r\n  }\r\n  if (asset.url && asset.type === \"svg\") {\r\n    return <AltrpSVG {...props} url={asset.url} rawSVG={asset.rawSVG} />;\r\n  }\r\n  if (! isSSR() && asset instanceof File) {\r\n    let refImg = React.createRef();\r\n    let fr = new FileReader();\r\n    fr.readAsDataURL(asset);\r\n    fr.onload = () => {\r\n      if (refImg.current) {\r\n        refImg.current.src = fr.result;\r\n        refImg.current.alt = asset.name;\r\n      }\r\n    };\r\n    return React.createElement(\"img\", {\r\n      ...props,\r\n      src: asset.url,\r\n      ref: refImg\r\n    });\r\n  }\r\n  switch (asset.assetType) {\r\n    case \"icon\": {\r\n      return iconsManager().renderIcon(asset.name, props);\r\n    }\r\n    case \"image\": {\r\n      return React.createElement(\"img\", { ...props, src: asset.url });\r\n    }\r\n    case \"media\": {\r\n      return React.createElement(\"img\", { ...props, src: asset.url });\r\n    }\r\n    case \"mediaBackground\": {\r\n      return React.createElement(\"div\", {\r\n        ...props,\r\n        style: { backgroundImage: `url(${asset.url})` }\r\n      });\r\n    }\r\n    case undefined: {\r\n      return React.createElement(\"img\", {\r\n        ...props,\r\n        src: \"/img/nullImage.png\"\r\n      });\r\n    }\r\n  }\r\n  return \"\";\r\n}\r\n\r\n/**\r\n * Парсим данный из строки в объект, если значение - путь, то берем значение из context\r\n * (если в context нет свойства, то не записываем)\r\n * @param {string} string\r\n * @param {AltrpModel} context\r\n * @param {boolean} allowObject\r\n * @param {boolean} replaceRight - нужно ли подставлять в значение параметра данные или оставить сырой шаблон\r\n * @param {boolean} replace - нужно ли подставлять в значение параметра данные или оставить сырой шаблон\r\n * @return {{}}\r\n */\r\nexport function parseParamsFromString(\r\n  string,\r\n  context = {},\r\n  allowObject = false,\r\n  replaceRight = true,\r\n  replace = true,\r\n) {\r\n  if (!(context instanceof AltrpModel)) {\r\n    context = new AltrpModel(context);\r\n  }\r\n  const params = {};\r\n  const urlParams =\r\n    window.currentRouterMatch instanceof AltrpModel\r\n      ? window.currentRouterMatch.getProperty(\"params\")\r\n      : {};\r\n\r\n  if (!string) {\r\n    return params;\r\n  }\r\n  const lines = string.split(\"\\n\");\r\n  lines.forEach(line => {\r\n    let [left, right] = line.split(\"|\");\r\n    if (!left || !right) {\r\n      return;\r\n    }\r\n    left = left.trim();\r\n    right = right.trim();\r\n    if (replace && left.indexOf(\"{{\") !== -1) {\r\n      left = replaceContentWithData(left);\r\n    }\r\n    if (replace && right.match(/{{([\\s\\S]+?)(?=}})/g)) {\r\n      if (\r\n        context.getProperty(\r\n          right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\r\n        ) ||\r\n        getDataByPath(right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\"))\r\n      ) {\r\n        //todo ошибка в IOS\r\n        params[left] =\r\n          context.getProperty(\r\n            right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\r\n          ) ||\r\n          getDataByPath(\r\n            right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\r\n          ) ||\r\n          \"\";\r\n      } else {\r\n        replaceRight\r\n          ? (params[left] = urlParams[\r\n              right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\r\n            ]\r\n              ? urlParams[\r\n                  right.match(/{{([\\s\\S]+?)(?=}})/g)[0].replace(\"{{\", \"\")\r\n                ]\r\n              : \"\")\r\n          : (params[left] = right);\r\n      }\r\n    } else {\r\n      params[left] = right;\r\n    }\r\n    if (!allowObject && _.isObject(params[left])) {\r\n      delete params[left];\r\n    }\r\n  });\r\n  return params;\r\n}\r\n\r\n/**\r\n * Функция для проверки условий\r\n * @param {array} conditions\r\n * @param {boolean} AND - логичекое И или ИЛИ\r\n * @param {AltrpModel} model\r\n * @param {boolean} dataByPath - брать ли данные из getDataByPath\r\n * @return {boolean}\r\n */\r\nexport function conditionsChecker(\r\n  conditions = [],\r\n  AND = true,\r\n  model,\r\n  dataByPath = true\r\n) {\r\n  if (!conditions.length) {\r\n    return true;\r\n  }\r\n  let result = AND;\r\n  _.each(conditions, c => {\r\n    if (AND) {\r\n      result *= conditionChecker(c, model, dataByPath);\r\n    } else {\r\n      result += conditionChecker(c, model, dataByPath);\r\n    }\r\n  });\r\n  return !!result;\r\n}\r\n\r\n/**\r\n * Функция для проверки одного условия\r\n * @param c\r\n * @param {AltrpModel} model\r\n * @param {boolean} dataByPath - брать ли данный из getDataByPath\r\n * @return {boolean}\r\n */\r\nfunction conditionChecker(c, model, dataByPath = true) {\r\n  let result = 0;\r\n  const { operator } = c;\r\n  let { modelField: left, value } = c;\r\n  if (dataByPath) {\r\n    value = getDataByPath(value, \"\", model, true);\r\n    left = getDataByPath(left, \"\", model);\r\n    return altrpCompare(left, value, operator);\r\n  }\r\n  return altrpCompare(model.getProperty(left), value, operator);\r\n  switch (operator) {\r\n    case \"empty\": {\r\n      return !model.getProperty(modelField, \"\");\r\n    }\r\n    case \"not_empty\": {\r\n      return !!model.getProperty(modelField, \"\");\r\n    }\r\n    case \"==\": {\r\n      return _.isEqual(model.getProperty(modelField, \"\"), value);\r\n    }\r\n    case \"<>\": {\r\n      return !_.isEqual(model.getProperty(modelField, \"\"), value);\r\n    }\r\n    case \">\": {\r\n      return Number(model.getProperty(modelField, \"\")) > Number(value);\r\n    }\r\n    case \">=\": {\r\n      return Number(model.getProperty(modelField, \"\")) >= Number(value);\r\n    }\r\n    case \"<\": {\r\n      return Number(model.getProperty(modelField, \"\")) < Number(value);\r\n    }\r\n    case \"<=\": {\r\n      return Number(model.getProperty(modelField, \"\")) <= Number(value);\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\n/**\r\n * Установить данные\r\n * @param {string} path\r\n * @param {*} value\r\n * @param {function | null} dispatch\r\n * @return {boolean}\r\n */\r\nexport function setDataByPath(path = \"\", value, dispatch = null) {\r\n  if (!path) {\r\n    return false;\r\n  }\r\n  if (path.indexOf(\",\") !== -1) {\r\n    let result = path\r\n      .split(\",\")\r\n      .map(path => setDataByPath(path, value, dispatch));\r\n    return true;\r\n  }\r\n  path = path.replace(\"{{\", \"\").replace(\"}}\", \"\");\r\n  path = path.trim();\r\n  switch (value) {\r\n    case \"true\":\r\n      value = true;\r\n      break;\r\n    case \"false\":\r\n      value = false;\r\n      break;\r\n    case \"null\":\r\n      value = null;\r\n      break;\r\n    case \"undefined\":\r\n      value = undefined;\r\n      break;\r\n  }\r\n\r\n  if (path.indexOf(\"altrppagestate.\") === 0) {\r\n    path = path.replace(\"altrppagestate.\", \"\");\r\n    if (!path) {\r\n      return false;\r\n    }\r\n    const oldValue = appStore.getState().altrpPageState.getProperty(path);\r\n    if (_.isEqual(oldValue, value)) {\r\n      return true;\r\n    }\r\n    if (_.isFunction(dispatch)) {\r\n      dispatch(changePageState(path, value));\r\n    } else {\r\n      appStore.dispatch(changePageState(path, value));\r\n    }\r\n    return true;\r\n  }\r\n  if (path.indexOf(\"altrpmeta.\") === 0) {\r\n    path = path.replace(\"altrpmeta.\", \"\");\r\n    if (!path) {\r\n      return false;\r\n    }\r\n    const oldValue = appStore.getState().altrpMeta.getProperty(path);\r\n    if (_.isEqual(oldValue, value)) {\r\n      return true;\r\n    }\r\n    if (_.isFunction(dispatch)) {\r\n      dispatch(changeAltrpMeta(path, value));\r\n    } else {\r\n      appStore.dispatch(changeAltrpMeta(path, value));\r\n    }\r\n    return true;\r\n  }\r\n  if (path.indexOf(\"altrpuser.local_storage.\") === 0) {\r\n    path = path.replace(\"altrpuser.\", \"\");\r\n    if (!path) {\r\n      return false;\r\n    }\r\n    const oldValue = appStore.getState().currentUser.getProperty(path);\r\n    if (_.isEqual(oldValue, value)) {\r\n      return true;\r\n    }\r\n    if (_.isFunction(dispatch)) {\r\n      dispatch(changeCurrentUserProperty(path, value));\r\n    } else {\r\n      appStore.dispatch(changeCurrentUserProperty(path, value));\r\n    }\r\n    return true;\r\n  }\r\n  if (path.indexOf(\"altrpforms.\") === 0) {\r\n    path = path.replace(\"altrpforms.\", \"\");\r\n    if (!path) {\r\n      return false;\r\n    }\r\n    const [formId, fieldName] = path.split(\".\");\r\n    const { formsStore } = appStore.getState();\r\n\r\n    const oldValue = _.get(formsStore, path);\r\n    if (_.isEqual(oldValue, value)) {\r\n      return true;\r\n    }\r\n    if (_.isFunction(dispatch)) {\r\n      dispatch(changeFormFieldValue(path, value));\r\n    } else {\r\n      appStore.dispatch(changeFormFieldValue(fieldName, value, formId, true));\r\n    }\r\n  } else\r\n  if (path.indexOf(\"altrpelements.\") === 0) {\r\n    const pathElements = path.split(\".\");\r\n    let [prefix, elementId, updateType, ...propName] = pathElements;\r\n    const component = getComponentByElementId(elementId);\r\n    if (!component) {\r\n      return true;\r\n    }\r\n    propName =  propName.join('.');\r\n    switch (updateType) {\r\n      case \"settings\": {\r\n        component.props.element.updateSetting(value, propName);\r\n        if(window['h-altrp']){\r\n          let settings = component.props.element.settings;\r\n          settings = mutate.set(settings, propName, value)\r\n          appStore.dispatch(addSettings(component.props.element.getId(), component.props.element.getName(), settings));\r\n        }\r\n        return true;\r\n      }\r\n      default: {\r\n        return true;\r\n      }\r\n    }\r\n  } else\r\n  if (path.indexOf(\"altrpareas.\") === 0) {\r\n    const pathElements = path.split(\".\");\r\n    const [prefix,  areaName,  updateType, propName] = pathElements;\r\n    let area = window.page_areas.find(area => area.id === areaName);\r\n    if(area && updateType === 'settings'){\r\n      if(! (area instanceof Area)){\r\n        area = Area.areaFactory(area);\r\n      }\r\n      area.setSetting(propName, value);\r\n    }\r\n  } else\r\n  if (path.indexOf(\"altrpstorage.\") === 0) {\r\n    path = path.replace(\"altrpstorage.\", \"\");\r\n    const currentStorage = getDataFromLocalStorage(\"altrpstorage\", {});\r\n    _.set(currentStorage, path, value);\r\n    saveDataToLocalStorage(\"altrpstorage\", currentStorage);\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\n/**\r\n * Получить данные из окружения\r\n * @param {string} path\r\n * @param {*} _default\r\n * @param {{} | AltrpModel | null} context\r\n * @param {boolean} altrpCheck - проверять ли altrp\r\n * @return {*}\r\n */\r\nexport function getDataByPath(\r\n  path = \"\",\r\n  _default = null,\r\n  context = null,\r\n  altrpCheck = false\r\n) {\r\n  if (!path) {\r\n    return _default;\r\n  }\r\n  if (path.indexOf(\"{{\") !== -1) {\r\n    path = replaceContentWithData(path, context);\r\n  }\r\n  /**\r\n   * проверим путь\r\n   */\r\n  if (altrpCheck && path.trim().indexOf(\"altrp\") !== 0) {\r\n    return path;\r\n  }\r\n  path = path.trim();\r\n  let trueValue, falseValue;\r\n  if (path.indexOf(\"?\") !== -1 && path.indexOf(\":\") !== -1) {\r\n    let [_path, _right] = path.split(\"?\");\r\n    [trueValue, falseValue] = _right.split(\":\");\r\n    trueValue = trueValue.trim();\r\n    if (trueValue.indexOf(\".\") !== -1) {\r\n      trueValue = getDataByPath(trueValue, _default, context);\r\n    }\r\n\r\n    falseValue = falseValue.trim();\r\n    if (falseValue.indexOf(\".\") !== -1) {\r\n      falseValue = getDataByPath(falseValue, _default, context);\r\n    }\r\n    path = _path.trim();\r\n  }\r\n  /**\r\n   * @type {AltrpModel} currentModel\r\n   */\r\n  let {\r\n    currentModel,\r\n    currentDataStorage,\r\n    altrpresponses,\r\n    formsStore,\r\n    altrpPageState,\r\n    altrpPage,\r\n    currentUser,\r\n    altrpMeta\r\n  } = appStore.getState();\r\n  if (context) {\r\n    currentModel =\r\n      context instanceof AltrpModel ? context : new AltrpModel(context);\r\n  }\r\n  let urlParams =\r\n    window.currentRouterMatch instanceof AltrpModel\r\n      ? window.currentRouterMatch.getProperty(\"params\")\r\n      : {};\r\n\r\n  let queryData = queryString.parseUrl(window.location.href).query;\r\n\r\n  urlParams = _.assign(queryData, urlParams);\r\n\r\n  let value = _default;\r\n  if (!_.isString(path)) {\r\n    return value;\r\n  }\r\n  if (path.indexOf(\"altrpdata.\") === 0) {\r\n    path = path.replace(\"altrpdata.\", \"\");\r\n    value = currentDataStorage\r\n      ? currentDataStorage.getProperty(path, _default)\r\n      : \"\";\r\n  } else if (path.indexOf(\"altrpresponses.\") === 0) {\r\n    path = path.replace(\"altrpresponses.\", \"\");\r\n    value = altrpresponses ? altrpresponses.getProperty(path, _default) : \"\";\r\n  } else if (path.indexOf(\"altrpmeta.\") === 0) {\r\n    path = path.replace(\"altrpmeta.\", \"\");\r\n    value = altrpMeta ? altrpMeta.getProperty(path, _default) : \"\";\r\n  } else if (path.indexOf(\"altrppagestate.\") === 0) {\r\n    path = path.replace(\"altrppagestate.\", \"\");\r\n    value = altrpPageState ? altrpPageState.getProperty(path, _default) : \"\";\r\n  } else if (path.indexOf(\"altrpuser.\") === 0) {\r\n    path = path.replace(\"altrpuser.\", \"\");\r\n    value = currentUser ? currentUser.getProperty(path, _default) : \"\";\r\n  } else if (path === \"altrpuser\") {\r\n    value = currentUser.getData();\r\n  } else if (path === \"altrpmodel\") {\r\n    value = currentModel.getData();\r\n  } else if (path.indexOf(\"altrptime.\") === 0) {\r\n    value = getTimeValue(path.replace(\"altrptime.\", \"\"));\r\n  } else if (path.indexOf(\"altrpforms.\") === 0) {\r\n    value = _.get(formsStore, path.replace(\"altrpforms.\", \"\"), _default);\r\n  } else if (path.indexOf(\"altrppage.\") === 0) {\r\n    value = altrpPage\r\n      ? altrpPage.getProperty(path.replace(\"altrppage.\", \"\"), _default)\r\n      : \"\";\r\n  } else if (path.indexOf(\"altrpelements.\") === 0) {\r\n    const pathElements = path.split(\".\");\r\n    const [prefix, elementId, updateType, propName] = pathElements;\r\n    const component = getComponentByElementId(elementId);\r\n    if (!component) {\r\n      value = \"\";\r\n    } else {\r\n      switch (updateType) {\r\n        case \"settings\":\r\n          {\r\n            value = component.props.element.getSettings(propName);\r\n          }\r\n          break;\r\n        default: {\r\n          value = \"\";\r\n        }\r\n      }\r\n    }\r\n  } else if (path.indexOf(\"altrpstorage.\") === 0) {\r\n    path = path.replace(\"altrpstorage.\", \"\");\r\n    value = getDataFromLocalStorage(\"altrpstorage\", {});\r\n    value = _.get(value, path, _default);\r\n  } else if (path.indexOf(\"altrpareas.\") === 0) {\r\n    const pathElements = path.split(\".\");\r\n    const [prefix,  areaName,  updateType, propName] = pathElements;\r\n    let area = window.page_areas.find(area => area.id === areaName);\r\n    if(area && updateType === 'settings'){\r\n      if(! (area instanceof Area)){\r\n        area = Area.areaFactory(area);\r\n      }\r\n      value = area.getSetting(propName, _default);\r\n    }\r\n  } else {\r\n    value = currentModel.getProperty(path)\r\n      ? currentModel.getProperty(path)\r\n      : urlParams[path];\r\n    if (!value) {\r\n      value = _default;\r\n    }\r\n  }\r\n  if (trueValue || falseValue) {\r\n    value = value ? trueValue : falseValue;\r\n  }\r\n  return value;\r\n}\r\n\r\n/**\r\n * Извелкает путь из строки\r\n * @param {string} string\r\n * @return {string}\r\n */\r\nexport function extractPathFromString(string = \"\") {\r\n  let path = \"\";\r\n  if (_.isString(string)) {\r\n    // path = string.match(/(?<={{)([\\s\\S]+?)(?=}})/g)[0]\r\n    path = _.get(string.match(/{{([\\s\\S]+?)(?=}})/g), \"0\", \"\").replace(\r\n      \"{{\",\r\n      \"\"\r\n    );\r\n  }\r\n  return path;\r\n}\r\n/**\r\n * Возвращает новый объект из свояств объекта, в именах которых присутствует префикс prefix\r\n * @param {string} prefix - строка для поиска (например 'test')\r\n * @param {{}} object - если в объекте есть свойство test__test то вернет {test: test__test_value}\r\n * @return {{}}\r\n */\r\nexport function getObjectByPrefix(prefix = \"\", object = {}) {\r\n  let result = {};\r\n  if (!prefix) {\r\n    return result;\r\n  }\r\n  _.forEach(object, (value, key) => {\r\n    if (key.indexOf(`${prefix}__`, \"\") === 0) {\r\n      result[key.replace(`${prefix}__`, \"\")] = value;\r\n    }\r\n  });\r\n  return result;\r\n}\r\n\r\n/**\r\n * Возвращает объект из json-строки если возможно\r\n * @param {string} string\r\n * @param {*} _default\r\n * @return {*}\r\n */\r\nexport function mbParseJSON(string, _default = null) {\r\n  try {\r\n    return JSON.parse(string);\r\n  } catch (e) {\r\n    return _default === null ? string : _default;\r\n  }\r\n}\r\n\r\n/**\r\n * Функция для сравнения значений\r\n * @param leftValue\r\n * @param rightValue\r\n * @param operator\r\n * @return {boolean}\r\n */\r\nexport function altrpCompare(\r\n  leftValue = \"\",\r\n  rightValue = \"\",\r\n  operator = \"empty\"\r\n) {\r\n  switch (operator) {\r\n    case \"empty\": {\r\n      return _.isEmpty(leftValue);\r\n    }\r\n    case \"not_empty\": {\r\n      return !_.isEmpty(leftValue);\r\n    }\r\n    case \"null\": {\r\n      return !leftValue;\r\n    }\r\n    case \"not_null\": {\r\n      return !!leftValue;\r\n    }\r\n    case \"==\": {\r\n      if (!leftValue && !rightValue) {\r\n        return true;\r\n      }\r\n      if (!(_.isObject(leftValue) || _.isObject(rightValue))) {\r\n        return leftValue == rightValue;\r\n      } else {\r\n        return _.isEqual(leftValue, rightValue);\r\n      }\r\n    }\r\n    case \"===\": {\r\n      return _.isEqual(leftValue, rightValue);\r\n    }\r\n    case \"<>\": {\r\n      return !_.isEqual(leftValue, rightValue);\r\n    }\r\n    case \">\": {\r\n      return Number(leftValue) > Number(rightValue);\r\n    }\r\n    case \">=\": {\r\n      return Number(leftValue) >= Number(rightValue);\r\n    }\r\n    case \"<\": {\r\n      return Number(leftValue) < Number(rightValue);\r\n    }\r\n    case \"<=\": {\r\n      return Number(leftValue) <= Number(rightValue);\r\n    }\r\n    case \"in\": {\r\n      if (_.isString(rightValue)) {\r\n        return rightValue.indexOf(leftValue) !== -1;\r\n      }\r\n      if (!_.isArray(rightValue)) {\r\n        return false;\r\n      }\r\n      let result = false;\r\n      rightValue.forEach(item => {\r\n        if (!result) {\r\n          result = altrpCompare(leftValue, item, \"==\");\r\n        }\r\n      });\r\n      return result;\r\n    }\r\n    case \"not_in\": {\r\n      return !altrpCompare(leftValue, rightValue, \"in\");\r\n    }\r\n    case \"contain\": {\r\n      if (_.isString(leftValue)) {\r\n        return leftValue.indexOf(rightValue) !== -1;\r\n      }\r\n      if (!_.isArray(leftValue)) {\r\n        return false;\r\n      }\r\n      let result = false;\r\n      leftValue.forEach(item => {\r\n        if (!result) {\r\n          result = altrpCompare(rightValue, item, \"contain\");\r\n        }\r\n      });\r\n      return result;\r\n    }\r\n    case \"not_contain\": {\r\n      return !altrpCompare(leftValue, rightValue, \"contain\");\r\n    }\r\n  }\r\n}\r\n\r\nexport const CONDITIONS_OPTIONS = [\r\n  {\r\n    value: \"empty\",\r\n    label: \"Empty\"\r\n  },\r\n  {\r\n    value: \"not_empty\",\r\n    label: \"Not Empty\"\r\n  },\r\n  {\r\n    value: \"null\",\r\n    label: \"Null\"\r\n  },\r\n  {\r\n    value: \"not_null\",\r\n    label: \"Not Null\"\r\n  },\r\n  {\r\n    value: \"==\",\r\n    label: \"Equals\"\r\n  },\r\n  {\r\n    value: \"<>\",\r\n    label: \"Not Equals\"\r\n  },\r\n  {\r\n    value: \"between\",\r\n    label: \"Between\"\r\n  },\r\n  {\r\n    value: \">\",\r\n    label: \">\"\r\n  },\r\n  {\r\n    value: \">=\",\r\n    label: \">=\"\r\n  },\r\n  {\r\n    value: \"<\",\r\n    label: \"<\"\r\n  },\r\n  {\r\n    value: \"<=\",\r\n    label: \"<=\"\r\n  },\r\n  {\r\n    value: \"in\",\r\n    label: \"In\"\r\n  },\r\n  {\r\n    value: \"not_in\",\r\n    label: \"Not In\"\r\n  },\r\n  {\r\n    value: \"contain\",\r\n    label: \"Contain\"\r\n  },\r\n  {\r\n    value: \"not_contain\",\r\n    label: \"Not Contain\"\r\n  }\r\n];\r\n\r\nexport function isElementTopInViewport(top, scrollTop, clientHeight) {\r\n  return top > scrollTop && top < scrollTop + clientHeight;\r\n}\r\n\r\nexport function getTopPosition(element) {\r\n  let top = element.offsetTop;\r\n\r\n  while (element.offsetParent) {\r\n    element = element.offsetParent;\r\n    top += element.offsetTop;\r\n  }\r\n\r\n  return top;\r\n}\r\n\r\n/**\r\n * Получить какое-то время по шаблону `YYYY-MM-DD`\r\n * @param {string} path\r\n * @param {string | null} defaultValue\r\n */\r\nexport function getTimeValue(path, defaultValue = null) {\r\n  let value = defaultValue;\r\n\r\n  switch (path) {\r\n    case \"now\":\r\n      {\r\n        value = _.now();\r\n      }\r\n      break;\r\n    case \"month_start\":\r\n      {\r\n        value = startOfMonth(new Date());\r\n      }\r\n      break;\r\n    case \"prev_month_start\":\r\n      {\r\n        value = startOfMonth(new Date(), -1);\r\n      }\r\n      break;\r\n    case \"year_start\":\r\n      {\r\n        value = startOfYear(new Date());\r\n      }\r\n      break;\r\n    case \"prev_year_start\":\r\n      {\r\n        value = startOfYear(new Date(), -1);\r\n      }\r\n      break;\r\n    case \"prev_week_start\":\r\n      {\r\n        value = getPrevWeekStart();\r\n      }\r\n      break;\r\n    case \"next_week_start\":\r\n      {\r\n        value = getNextWeekStart();\r\n      }\r\n      break;\r\n    case \"week_start\":\r\n      {\r\n        value = getWeekStart();\r\n      }\r\n      break;\r\n  }\r\n  const {moment} = window.altrpHelpers;\r\n  value = moment(value).format(\"YYYY-MM-DD\");\r\n  return value;\r\n}\r\n\r\n/**\r\n * Получить начало месяца\r\n * @param {Date} date\r\n * @param {int} monthShift\r\n * @return {Date}\r\n */\r\nexport function startOfMonth(date, monthShift = 0) {\r\n  return new Date(date.getFullYear(), date.getMonth() + monthShift, 1);\r\n}\r\n/**\r\n * Получить начало месяца\r\n * @param {Date} date\r\n * @param {int} yearShift\r\n * @return {Date}\r\n */\r\nexport function startOfYear(date, yearShift = 0) {\r\n  return new Date(date.getFullYear() + yearShift, 0, 1);\r\n}\r\n/**\r\n * Получить начало месяца\r\n * @param {Date} date\r\n * @param {int} weekShift\r\n * @return {Date}\r\n */\r\nexport function startOfWeek(date, weekShift = 0) {\r\n  const {moment} = window.altrpHelpers;\r\n  return moment(\r\n    new Date(\r\n      date.getFullYear(),\r\n      date.getMonth(),\r\n      date.getDate() + weekShift * 7\r\n    )\r\n  ).firstDayOfWeek();\r\n}\r\n\r\n/**\r\n * Получить ссылку на состояние хранилища\r\n * @return {*}\r\n */\r\nexport function getCurrentStoreState() {\r\n  return appStore.getState();\r\n}\r\n\r\n/**\r\n * Скроллит к элементу\r\n * @param {{} | HTMLElement}scrollbars\r\n * @param {{}}element\r\n */\r\nexport function scrollToElement(scrollbars, element) {\r\n  let { container } = scrollbars;\r\n  if(scrollbars instanceof HTMLElement){\r\n    container = scrollbars;\r\n    let scroll = getOffsetTopInElement(element, scrollbars);\r\n    if(scroll){\r\n      scrollbars.scrollTop =scroll;\r\n    }\r\n\r\n  }\r\n  /**\r\n   * @member {HTMLElement} container\r\n   */\r\n  if (!container) {\r\n    return;\r\n  }\r\n  if (!_.isFunction(scrollbars.scrollTop)) {\r\n    return;\r\n  }\r\n\r\n  let parent = element.offsetParent;\r\n  let top = element.offsetTop;\r\n\r\n  while (parent !== container) {\r\n    if (! parent) {\r\n      /**\r\n       * ушли в самый корень ДОМ и контейнер не встретился\r\n       */\r\n      return;\r\n    }\r\n    top += parent.offsetTop;\r\n    parent = parent.offsetParent;\r\n  }\r\n  /**\r\n   * не получили каеое-либо значение\r\n   */\r\n  if (! top) {\r\n    return;\r\n  }\r\n  scrollbars.scrollTop(top);\r\n}\r\n\r\n/**\r\n * Вернет HTML элемент React компонента, у которого id = elementId\r\n * @param {string} elementId\r\n * @return {null | HTMLElement}\r\n */\r\nexport function getHTMLElementById(elementId = \"\") {\r\n  let HTMLElement = null;\r\n  if (!elementId || !elementId.trim()) {\r\n    return HTMLElement;\r\n  }\r\n  elementId = elementId.trim();\r\n  appStore.getState().elements.forEach(el => {\r\n    if (!el.elementWrapperRef.current) {\r\n      return;\r\n    }\r\n    if (!el.elementWrapperRef.current.id) {\r\n      return;\r\n    }\r\n    if (\r\n      el.elementWrapperRef.current.id\r\n        .toString()\r\n        .split(\" \")\r\n        .indexOf(elementId) !== -1\r\n    ) {\r\n      HTMLElement = el.elementWrapperRef.current;\r\n    }\r\n  });\r\n  return HTMLElement;\r\n}\r\n\r\n/**\r\n * Вернет HTML  React компонента, у которого props.element = element\r\n * @param {FrontElement} element\r\n * @return {null | HTMLElement}\r\n */\r\nexport function getWrapperHTMLElementByElement(element) {\r\n  if (!element) {\r\n    return null;\r\n  }\r\n  let HTMLElement = null;\r\n  appStore.getState().elements.forEach(el => {\r\n    if (element === el.props.element) {\r\n      HTMLElement = el.elementWrapperRef.current;\r\n    }\r\n  });\r\n  return HTMLElement;\r\n}\r\n/**\r\n * Вернет HTML  React компонент, у которого elementWrapperRef.current.id = elementId\r\n * @param {string} elementId\r\n * @return {null | HTMLElement}\r\n */\r\nexport function getComponentByElementId(elementId = \"\") {\r\n  let component = null;\r\n  if (!elementId || !elementId.trim()) {\r\n    return component;\r\n  }\r\n  elementId = elementId.trim();\r\n  appStore.getState().elements.forEach(el => {\r\n    if (!el.elementWrapperRef.current) {\r\n      return;\r\n    }\r\n    if (!el.elementWrapperRef.current.id) {\r\n      return;\r\n    }\r\n    if (\r\n      el.elementWrapperRef.current.id\r\n        .toString()\r\n        .split(\" \")\r\n        .indexOf(elementId) !== -1\r\n    ) {\r\n      component = el;\r\n    }\r\n  });\r\n  return component;\r\n}\r\n\r\n/**\r\n * Начало следующей недели\r\n * @return {moment.Moment}\r\n */\r\nfunction getNextWeekStart() {\r\n  const {moment} = window.altrpHelpers;\r\n  let today = moment();\r\n  let daystoMonday = 7 - (today.isoWeekday() - 1);\r\n  return today.add(daystoMonday, \"days\");\r\n}\r\n\r\n/**\r\n * Начало текущей недели\r\n * @return {moment.Moment}\r\n */\r\nfunction getWeekStart() {\r\n  const {moment} = window.altrpHelpers;\r\n  let today = moment();\r\n  let daystoMonday = today.isoWeekday() - 1;\r\n  return today.subtract(daystoMonday, \"days\");\r\n}\r\n\r\n/**\r\n * Конец Следующей недели\r\n * @return {moment.Moment}\r\n */\r\nfunction getNextWeekEnd() {\r\n  let nextMonday = getNextWeekStart();\r\n  return nextMonday.add(\"days\", 6);\r\n}\r\n\r\n/**\r\n * Начало предыдущей недели\r\n * @return {moment.Moment}\r\n */\r\nfunction getPrevWeekStart() {\r\n  const {moment} = window.altrpHelpers;\r\n  let today = moment();\r\n  let daystoLastMonday = today.isoWeekday() - 1 + 7;\r\n  return today.subtract(daystoLastMonday, \"days\");\r\n}\r\n\r\n/**\r\n * Конец предыдущей недели\r\n * @return {moment.Moment}\r\n */\r\nfunction getPrevWeekEnd() {\r\n  let lastMonday = getPrevWeekStart();\r\n  return lastMonday.add(\"days\", 6);\r\n}\r\n\r\n/**\r\n * Удаляет пустые свойства в объектах\r\n */\r\nexport function clearEmptyProps() {}\r\n\r\n/**\r\n * Заменяет в тексте конструкции типа {{altrpdata...}} на данные\r\n * @param content\r\n * @param {{} | null} modelContext\r\n */\r\n\r\nexport function replaceContentWithData(content = \"\", modelContext = null) {\r\n  if(window.SSR){\r\n    return  content;\r\n  }\r\n  let paths = _.isString(content) ? content.match(/{{([\\s\\S]+?)(?=}})/g) : null;\r\n  if (_.isArray(paths)) {\r\n    paths.forEach(path => {\r\n      path = path.replace(\"{{\", \"\");\r\n      let value = getDataByPath(path, \"\", modelContext);\r\n      if (value === 0) {\r\n        value = \"0\";\r\n      }\r\n      path = escapeRegExp(path);\r\n      content = content.replace(new RegExp(`{{${path}}}`, \"g\"), value || \"\");\r\n    });\r\n  }\r\n  return content;\r\n}\r\n\r\n/**\r\n * Вспомогательные функции для работы с данными виджетов\r\n */\r\nwindow.altrphelpers = {\r\n  /**\r\n   * Возвращает сумму полей в массиве объектов\r\n   * @param {string}fieldName\r\n   * @return {number}\r\n   */\r\n  sumFields: function sumFields(fieldName) {\r\n    let sum = 0;\r\n    if (!_.isObject(this.context)) {\r\n      return sum;\r\n    }\r\n    if (!_.isArray(this.context)) {\r\n      this.context = [this.context];\r\n    }\r\n    this.context.forEach(c => {\r\n      sum += Number(_.get(c, fieldName)) || 0;\r\n    });\r\n    return sum;\r\n  }\r\n};\r\n\r\n/**\r\n * Функция выводит определенный элемент на печать\r\n * @params {HTMLElement[]} elements\r\n * @params {null || HTMLElement} stylesTag\r\n */\r\nexport function printElements(elements, title = \"\") {\r\n  let myWindow = window.open(\"\", \"my div\", \"height=400,width=1200\");\r\n  myWindow.document.write(`<html><head><title>${title}</title></head>`);\r\n  myWindow.document.write(\"<body >\");\r\n  elements = _.isArray(elements) ? elements : [elements];\r\n  let headContent = '';\r\n  myWindow.document.write(\"</body></html>\");\r\n  let bodyContent = '';\r\n  elements.forEach(element => {\r\n    if(element instanceof HTMLHeadElement){\r\n      headContent = element.innerHTML;\r\n      return\r\n    }\r\n    bodyContent += element.outerHTML;\r\n  });\r\n  myWindow.document.close(); // necessary for IE >= 10\r\n  myWindow.document.head.innerHTML = headContent;\r\n  bodyContent = bodyContent\r\n    .replace(/<tr/g, '<div className=\"altrp-table-tr\"')\r\n    .replace(/<th/g, '<div')\r\n    .replace(/<\\/tr>/g, '</div>')\r\n    .replace(/<\\/th>/g, '</div>')\r\n  myWindow.document.body.innerHTML = bodyContent;\r\n  myWindow.focus(); // necessary for IE >= 10\r\n  delay(250).then(()=>{\r\n    myWindow.print();\r\n    myWindow.close();\r\n  })\r\n  return true;\r\n}\r\n\r\n/**\r\n * Функция конвертирует HTML в PDF\r\n * @params {HTMLElement[]} element\r\n * @params {string} filename\r\n */\r\nexport async function elementsToPdf(elements, filename = \"\") {\r\n  let html2pdf = (await import(/* webpackChunkName: 'html2pdf' */\"html2pdf.js\")).default;\r\n  elements = elements.body ? elements.body : elements;\r\n  if (!elements) {\r\n    return {\r\n      success: true\r\n    };\r\n  }\r\n  let myWindow = window.open(\"\", \"my div\", \"height=400,width=1440\");\r\n  myWindow.document.write(`<html><head><title></title></head>`);\r\n  myWindow.document.write(\"</head><body >\");\r\n  elements = _.isArray(elements) ? elements : [elements];\r\n  elements.forEach(element => {\r\n    myWindow.document.write(element.outerHTML);\r\n  });\r\n  myWindow.document.write(\"</body></html>\");\r\n  return new Promise((resolve, reject) => {\r\n    html2pdf()\r\n      .from(myWindow.document.body)\r\n      .save(filename);\r\n    myWindow.close();\r\n    resolve({ success: true });\r\n  });\r\n}\r\n\r\n/**\r\n * Забирает данные из HTML таблицы\r\n * @param {{}}HTMLElement\r\n */\r\nexport function dataFromTable(HTMLElement) {\r\n  const data = [];\r\n  const headers = [];\r\n  if (!(HTMLElement && HTMLElement.querySelectorAll)) {\r\n    return data;\r\n  }\r\n  let table = HTMLElement.querySelector(\".altrp-table\");\r\n  if (!table && HTMLElement.querySelector(\".altrp-table-tr\")) {\r\n    table = HTMLElement;\r\n  }\r\n  if (!table) {\r\n    return data;\r\n  }\r\n  const ths = table.querySelectorAll(\".altrp-table-th\");\r\n  _.each(ths, th => {\r\n    // if (th.innerText) {\r\n    headers.push(th.innerText || \"\");\r\n    // }\r\n  });\r\n  const rows = table.querySelectorAll(\".altrp-table-tbody .altrp-table-tr\");\r\n  _.each(rows, row => {\r\n    const cells = row.querySelectorAll(\".altrp-table-td\");\r\n    const part = {};\r\n    headers.forEach((header, idx) => {\r\n      if (!header) {\r\n        return;\r\n      }\r\n      part[header] = cells[idx].innerText || \"\";\r\n    });\r\n    data.push(part);\r\n  });\r\n  return data;\r\n}\r\n\r\n/**\r\n * Создать csv-файл из данных и скачать\r\n * @param {{}} data\r\n * @param {string} filename\r\n */\r\nexport async function dataToCSV(data = {}, filename) {\r\n  filename = filename || \"File\";\r\n  if (!data) {\r\n    return { success: false };\r\n  }\r\n  if (_.isObject() && !_.isArray(data)) {\r\n    data = [data];\r\n  }\r\n  if (!_.isArray(data)) {\r\n    return { success: false };\r\n  }\r\n\r\n  let headers = _.toPairs(data[0]).map(([name, value]) => name);\r\n  let csvContent =\r\n    // 'data:text/csv;charset=utf-8,'\r\n    \"\" +\r\n    headers.join(\";\") +\r\n    \"\\n\" +\r\n    data\r\n      .map(item => {\r\n        let line = \"\";\r\n        headers.forEach((h, idx) => {\r\n          let value = _.get(item, h) || \"\";\r\n          if (_.isObject(value)) {\r\n            value = JSON.stringify(value);\r\n          }\r\n\r\n          line +=\r\n            (_.isString(value) ? value.replace(/\\s/g, \" \") : value) +\r\n            (headers.length === idx + 1 ? \"\" : \";\");\r\n        });\r\n        return line;\r\n      })\r\n      .join(\"\\n\");\r\n  let blob = new Blob([csvContent], {\r\n    type: \"text/csv\",\r\n    charset: \"windows-1251\"\r\n    // charset: 'utf-8',\r\n  });\r\n  let link = document.createElement(\"a\");\r\n  link.setAttribute(\"href\", window.URL.createObjectURL(blob));\r\n  link.setAttribute(\"download\", filename + \".csv\");\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  return { success: true };\r\n}\r\n\r\n/**\r\n * Генерация и загрузка XLS-файла\r\n * @param {Object data} Объект данных\r\n * @param {String} filename Имя файла\r\n */\r\nexport async function dataToXLS(data, filename = \"table\", templateName = \"\") {\r\n  const formData = new FormData();\r\n  formData.append(\"filename\", filename);\r\n  formData.append(\"data\", JSON.stringify(data));\r\n  formData.append(\"template\", templateName);\r\n\r\n  const response = await fetch(\"/api/export-excel\", {\r\n    method: \"POST\",\r\n    body: formData\r\n  });\r\n\r\n  return await response.blob();\r\n}\r\n\r\n/**\r\n * Генерация и загрузка XML-файла\r\n * @param {Object data} Объект данных\r\n * @param {String} filename Имя файла\r\n */\r\nexport async function dataToXML(data, filename = \"table\") {\r\n  const formData = new FormData();\r\n  formData.append(\"filename\", filename);\r\n  formData.append(\"data\", JSON.stringify(data));\r\n\r\n  const response = await fetch(\"/api/export-xml\", {\r\n    method: \"POST\",\r\n    body: formData\r\n  });\r\n\r\n  return await response.blob();\r\n}\r\n\r\n/**\r\n * Логиним пользователя\r\n * @param {{}} data\r\n * @param {string} formId\r\n * @return {Promise<{}>}\r\n */\r\nexport async function altrpLogin(data = {}, formId = \"login\") {\r\n  data.altrpLogin = true;\r\n  let res;\r\n  try {\r\n    res = await new Resource({ route: \"/login\" }).post(data);\r\n  } catch (error) {\r\n    let status = error.status;\r\n    if (error.res instanceof Promise) {\r\n      res = await error.res;\r\n    }\r\n    if (error instanceof Promise) {\r\n      res = await error;\r\n    }\r\n    res = mbParseJSON(res, {});\r\n    status && (res.__status = status);\r\n  }\r\n  appStore.dispatch(addResponseData(formId, res));\r\n  if (!(res.success || res._token)) {\r\n    return {\r\n      success: false\r\n    };\r\n  }\r\n  _token = res._token;\r\n\r\n  let currentUser = await new Resource({\r\n    route: \"/ajax/current-user\"\r\n  }).getAll();\r\n  currentUser = currentUser.data;\r\n  appStore.dispatch(changeCurrentUser(currentUser));\r\n  let routes = [];\r\n  try {\r\n    let routesData = await new Resource({\r\n      route: \"/ajax/routes\"\r\n    }).getAll();\r\n\r\n    for (let _data of routesData.pages) {\r\n      routes.push(Route.routeFabric(_data));\r\n    }\r\n    appStore.dispatch(changeAppRoutes(routes));\r\n  } catch (err) {\r\n    console.error(err);\r\n    return { success: false };\r\n  }\r\n  return { success: true };\r\n}\r\n\r\n/**\r\n * Выход\r\n * @return {Promise<{}>}\r\n */\r\nexport async function altrpLogout() {\r\n  let res = await new Resource({ route: \"/logout\" }).post();\r\n  if (!(res.success || res._token)) {\r\n    return {\r\n      success: false\r\n    };\r\n  }\r\n  _token = res._token;\r\n\r\n  let currentUser = await new Resource({\r\n    route: \"/ajax/current-user\"\r\n  }).getAll();\r\n  currentUser = currentUser.data;\r\n  appStore.dispatch(changeCurrentUser(currentUser));\r\n  let routes = [];\r\n  try {\r\n    let routesData = await new Resource({\r\n      route: \"/ajax/routes\"\r\n    }).getAll();\r\n\r\n    for (let _data of routesData.pages) {\r\n      routes.push(Route.routeFabric(_data));\r\n    }\r\n    appStore.dispatch(changeAppRoutes(routes));\r\n  } catch (err) {\r\n    console.error(err);\r\n    return { success: false };\r\n  }\r\n  return { success: true };\r\n}\r\n\r\nexport function cutString(string, maxLength = 80) {\r\n  if (string.length <= maxLength) return string;\r\n  return string.slice(0, maxLength) + \"...\";\r\n}\r\n\r\nexport function sortOptions(options, sortDirection) {\r\n  options.sort((a, b) =>\r\n    a.label.toLowerCase() > b.label.toLowerCase()\r\n      ? 1\r\n      : b.label.toLowerCase() > a.label.toLowerCase()\r\n      ? -1\r\n      : 0\r\n  );\r\n  return sortDirection === \"asc\" ? options : options.reverse();\r\n}\r\n/**\r\n * рекурсивно считает общую длину по пути\r\n * @param {{}} object\r\n * @param {string} path\r\n * @return {number}\r\n */\r\nexport function recurseCount(object = {}, path = \"\") {\r\n  let count = 0;\r\n  if (!path) {\r\n    return count;\r\n  }\r\n  let array = _.get(object, path, []);\r\n  if (!array.length) {\r\n    count++;\r\n    return count;\r\n  }\r\n  array.forEach(item => {\r\n    count += recurseCount(item, path);\r\n  });\r\n  return count;\r\n}\r\n\r\n/**\r\n * Вовращает AltrpModel, в котором храняться все источники данных на странице\r\n * @param {{}} model\r\n * @return {AltrpModel}\r\n */\r\nexport function getAppContext(model = null) {\r\n  const { currentModel } = appStore.getState();\r\n  if(model instanceof AltrpModel){\r\n    model = model.getData();\r\n  }\r\n  const currentModelData = model ? model : currentModel.getData();\r\n  const urlParams = _.cloneDeep(\r\n    window.currentRouterMatch instanceof AltrpModel\r\n      ? window.currentRouterMatch.getProperty(\"params\")\r\n      : {}\r\n  );\r\n  const context = new AltrpModel(_.assign(urlParams, currentModelData));\r\n  const {\r\n    altrpPageState,\r\n    altrpPage,\r\n    altrpMeta,\r\n    currentDataStorage,\r\n    currentUser,\r\n    altrpresponses,\r\n    formsStore\r\n  } = appStore.getState();\r\n\r\n  context.setProperty(\"altrpdata\", currentDataStorage);\r\n  context.setProperty(\"altrppagestate\", altrpPageState);\r\n  context.setProperty(\"altrpmeta\", altrpMeta);\r\n  context.setProperty(\"altrpuser\", currentUser);\r\n  context.setProperty(\"altrpresponses\", altrpresponses);\r\n  context.setProperty(\"altrpforms\", formsStore);\r\n  context.setProperty(\"altrppage\", altrpPage);\r\n  return context;\r\n}\r\n\r\n/**\r\n * Сохраняет состояние виджет в localStorage\r\n * Для виджетов ,которые могут сохранять состояния при смене страниц\r\n * @param {string} widgetId\r\n * @param {*} state\r\n * @return {boolean}\r\n */\r\nexport function storeWidgetState(widgetId, state = null) {\r\n  if (!widgetId) {\r\n    return false;\r\n  }\r\n  const path = `widget_state${widgetId}`;\r\n  return saveDataToLocalStorage(path, state);\r\n}\r\n/**\r\n * Забирает состояние из localStorage\r\n * Для виджетов ,которые могут сохранять состояния при смене страниц\r\n * @param {string} widgetId\r\n * @param {*} _default\r\n * @return {boolean}\r\n */\r\nexport function getWidgetState(widgetId, _default = null) {\r\n  if (!widgetId) {\r\n    return _default;\r\n  }\r\n  const path = `widget_state${widgetId}`;\r\n  return getDataFromLocalStorage(path, _default);\r\n}\r\n\r\n/**\r\n * Сохранить данные в localStorage\r\n * @param {string} name\r\n * @param {*} data\r\n * @return {boolean}\r\n */\r\nexport function saveDataToLocalStorage(name, data) {\r\n  if (!name) {\r\n    return false;\r\n  }\r\n  if (_.isObject(data)) {\r\n    data = JSON.stringify(data);\r\n  }\r\n  localStorage.setItem(name, data);\r\n  return true;\r\n}\r\n/**\r\n * Сохранить данные в localStorage\r\n * @param {string} name\r\n * @param {*} _default\r\n * @return {*}\r\n */\r\nexport function getDataFromLocalStorage(name, _default = undefined) {\r\n  if (!name) {\r\n    return _default;\r\n  }\r\n  let value = localStorage.getItem(name);\r\n  if (!value) {\r\n    return _default;\r\n  }\r\n  try {\r\n    value = JSON.parse(value);\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n  if (_.isString(value) && Number(value)) {\r\n    value = Number(value);\r\n  }\r\n  return value || _default;\r\n}\r\nexport function scrollbarWidth() {\r\n  // thanks too https://davidwalsh.name/detect-scrollbar-width\r\n  const scrollDiv = document.createElement(\"div\");\r\n  scrollDiv.setAttribute(\r\n    \"style\",\r\n    \"width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;\"\r\n  );\r\n  document.body.appendChild(scrollDiv);\r\n  const scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\r\n  document.body.removeChild(scrollDiv);\r\n  return scrollbarWidth;\r\n}\r\n\r\n/**\r\n * Добавляем свойство altrpIndex для всех эементов-объектов массива\r\n * для их идентификации внутри повторяющихся карточек\r\n * @param {[]} array\r\n */\r\nexport function setAltrpIndex(array = []) {\r\n  if (!_.isArray(array)) {\r\n    return;\r\n  }\r\n  array.forEach((item, idx) => {\r\n    if (!_.isObject(item)) {\r\n      return;\r\n    }\r\n    if (item instanceof AltrpModel) {\r\n      item.setProperty(\"altrpIndex\", idx);\r\n      return;\r\n    }\r\n    item.altrpIndex = idx;\r\n  });\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} font\r\n * @return {*}\r\n */\r\nexport function renderFontLink(font) {\r\n  if (altrpFontsSet[font] !== GOOGLE_FONT) {\r\n    return null;\r\n  }\r\n  font = font.replace(/ /g, \"+\");\r\n  font +=\r\n    \":100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic\";\r\n  let fontUrl =\r\n    \"https://fonts.googleapis.com/css?family=\" + font + \"&subset=cyrillic\";\r\n  fontUrl = encodeURI(fontUrl);\r\n  return <link rel=\"stylesheet\" key={fontUrl} href={fontUrl} />;\r\n}\r\n\r\n/**\r\n * Включен ли режим тестирования\r\n */\r\nexport function isAltrpTestMode() {\r\n  return window.location.href.indexOf(\"altrp-test=true\") > 0;\r\n}\r\n\r\n/**\r\n * случайная строка\r\n * @return {string}\r\n */\r\nexport function altrpRandomId() {\r\n  return Math.random()\r\n    .toString(36)\r\n    .substr(2, 9);\r\n}\r\n\r\n/**\r\n * Кнопки для пагинации\r\n * @param pageIndex\r\n * @param pageCount\r\n * @param first_last_buttons_count\r\n * @param middle_buttons_count\r\n * @return {*[]}\r\n */\r\nexport function generateButtonsArray(\r\n  pageIndex,\r\n  pageCount,\r\n  first_last_buttons_count,\r\n  middle_buttons_count\r\n) {\r\n  const buttonsSum = first_last_buttons_count + middle_buttons_count;\r\n  const lastButtons = Array.from(\r\n    { length: first_last_buttons_count },\r\n    (_, i) => pageCount - i - 1\r\n  ).reverse();\r\n  const middleButtons = Array.from(\r\n    { length: middle_buttons_count },\r\n    (_, i) => pageIndex - Math.floor(middle_buttons_count / 2) + i\r\n  );\r\n\r\n  if (pageIndex + 1 < buttonsSum) {\r\n    return [...Array(buttonsSum).keys(), \"ellipsis\", ...lastButtons];\r\n  }\r\n  if (\r\n    pageIndex >=\r\n    pageCount -\r\n      first_last_buttons_count -\r\n      1 -\r\n      Math.floor(middle_buttons_count / 2)\r\n  ) {\r\n    return [\r\n      ...Array(first_last_buttons_count).keys(),\r\n      \"ellipsis\",\r\n      ...Array.from(\r\n        { length: first_last_buttons_count + middle_buttons_count },\r\n        (_, i) => pageCount - i - 1\r\n      ).reverse()\r\n    ];\r\n  }\r\n\r\n  return [\r\n    ...Array(first_last_buttons_count).keys(),\r\n    \"ellipsis\",\r\n    ...middleButtons,\r\n    \"ellipsis\",\r\n    ...lastButtons\r\n  ];\r\n}\r\n\r\n/**\r\n * Проверяем текст на соответствие маске\r\n * @param {string} value\r\n * @param {[]} mask\r\n * @return {boolean}\r\n */\r\nexport function isValueMatchMask(value, mask) {\r\n  if (!value || value.length !== mask.length) {\r\n    return false;\r\n  }\r\n  return (\r\n    value.length &&\r\n    value\r\n      .split(\"\")\r\n      .every((char, index) => char === mask[index] || char.match(mask[index]))\r\n  );\r\n}\r\n\r\n/**\r\n * Вернуть экземпляр конвертера необходимого типа (array - ArrayConverter и т. д.)\r\n * @return {DataConverter}\r\n */\r\nexport function getConverter(data) {\r\n  switch (data.data_type) {\r\n    case \"array\":\r\n      return new ArrayConverter(data);\r\n  }\r\n  return new DataConverter();\r\n}\r\n\r\n/**\r\n * Конвертируются данные\r\n * @param {{} | []} settings\r\n * @param {*} data\r\n */\r\nexport function convertData(settings, data) {\r\n  if (_.isArray(settings)) {\r\n    settings.forEach(item => {\r\n      const converter = getConverter(item);\r\n      data = converter.convertData(data);\r\n    });\r\n  }\r\n  if (settings.data_type) {\r\n    const converter = getConverter(settings);\r\n    data = converter.convertData(data);\r\n  }\r\n  return data;\r\n}\r\nexport function renderIcon(isHidden, icon, defaultIcon, className) {\r\n  if (isHidden) return null;\r\n\r\n  return (\r\n    <span className={className}>\r\n      {icon && icon.assetType ? renderAssetIcon(icon) : defaultIcon}\r\n    </span>\r\n  );\r\n  // if()\r\n}\r\n\r\n/**\r\n * Перенаправление на другую страницу по настройкам LinkController\r\n * @param {{}} linkSettings\r\n * @param {{}} e\r\n * @param {{}} context\r\n */\r\nexport function redirect(linkSettings, e, context = {}) {\r\n  if (_.get(linkSettings, \"toPrevPage\")) {\r\n    if(window.frontAppRouter){\r\n      frontAppRouter.history.goBack();\r\n    } else {\r\n      history.back();\r\n    }\r\n    return;\r\n  }\r\n  if (!_.get(linkSettings, \"url\")) {\r\n    return;\r\n  }\r\n  e.preventDefault();\r\n  e.stopPropagation();\r\n  let { url } = linkSettings;\r\n  url = replaceContentWithData(url, context);\r\n  if (linkSettings.openInNew) {\r\n    window.open(url, \"_blank\");\r\n    return;\r\n  }\r\n  if (linkSettings.tag === \"a\" || ! window.frontAppRouter) {\r\n    window.location.assign(url);\r\n  } else {\r\n    frontAppRouter.history.push(url);\r\n  }\r\n\r\n}\r\n\r\nexport function validateEmail(email) {\r\n  const re = /^(([^<>()[\\]\\\\.,;:\\s@']+(\\.[^<>()[\\]\\\\.,;:\\s@']+)*)|('.+'))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n  return re.test(String(email).toLowerCase());\r\n}\r\n\r\n/**\r\n * значение настройки в зависимости от разрешения можно использовать вне виджетов с объектом настроек\r\n * @param {{}} settings - объект настроек\r\n * @param {string} settingName\r\n * @param {string} elementState\r\n * @param {*} _default\r\n * @return {*}\r\n */\r\nexport function getResponsiveSetting(\r\n  settings,\r\n  settingName,\r\n  elementState = \"\",\r\n  _default = null\r\n) {\r\n  let { currentScreen } = window.parent.appStore.getState();\r\n  let _settingName = `${settingName}_${elementState}_`;\r\n  if (currentScreen.name === CONSTANTS.DEFAULT_BREAKPOINT) {\r\n    let setting = settings[_settingName];\r\n    if (setting === undefined) {\r\n      setting = _.get(settings, settingName, _default);\r\n    }\r\n    return setting;\r\n  }\r\n  let suffix = currentScreen.name;\r\n  _settingName = `${settingName}_${elementState}_${suffix}`;\r\n  let setting = settings[_settingName];\r\n  if (setting === undefined) {\r\n    for (let screen of [...CONSTANTS.SCREENS].reverse()) {\r\n      if (\r\n        currentScreen.id < screen.id ||\r\n        screen.name === CONSTANTS.DEFAULT_BREAKPOINT\r\n      ) {\r\n        continue;\r\n      }\r\n\r\n      _settingName = `${settingName}_${elementState}_${screen.name}`;\r\n\r\n      if (settings[_settingName] !== undefined) {\r\n        setting = settings[_settingName];\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (setting === undefined) {\r\n    setting = _.get(settings, settingName, _default);\r\n  }\r\n  return setting;\r\n}\r\n\r\n/**\r\n * Заменяет false, null, true в строке на соответствующие значения\r\n * @param {string} value\r\n * @return {*}\r\n */\r\nexport function valueReplacement(value) {\r\n  switch (value) {\r\n    case \"true\":\r\n      return true;\r\n    case \"false\":\r\n      return false;\r\n    case \"null\":\r\n      return null;\r\n  }\r\n  return value;\r\n}\r\n\r\n/**\r\n * Задержка и с интерфейсом промиса\r\n * @param ms\r\n * @return {Promise}\r\n */\r\nexport function delay(ms) {\r\n  if (_.isString(ms)) {\r\n    ms = Number(ms);\r\n  }\r\n  return new Promise((resolve, reject) => {\r\n    setTimeout(resolve, ms);\r\n  });\r\n}\r\n\r\n/**\r\n * Подготавливает URL для шаблона письма\r\n * @param {string} url\r\n * @param {{} | null} context\r\n * @return {string}\r\n */\r\nexport function prepareURLForEmail(url, context = null) {\r\n  if (!_.isString(url) || !url) {\r\n    return url;\r\n  }\r\n  url = url.trim();\r\n  if (url.indexOf(\"http\") !== 0) {\r\n    url = location.origin + url;\r\n  }\r\n  return parseURLTemplate(url, context);\r\n}\r\n\r\nexport function parseIDFromYoutubeURL(youtubeURL) {\r\n  const startIndex = youtubeURL.indexOf(\"v=\") + 2;\r\n  const endIndex = youtubeURL.indexOf(\"&\", startIndex);\r\n\r\n  return youtubeURL.substring(startIndex, endIndex);\r\n}\r\n\r\n/**\r\n *\r\n * @param {{}} context\r\n * @return {{}}\r\n */\r\nexport function prepareContext(context) {\r\n  context.altrpdata = appStore.getState().currentDataStorage.getData();\r\n  context.altrpmodel = appStore.getState().currentModel.getData();\r\n  context.altrpuser = appStore.getState().currentUser.getData();\r\n  context.altrppagestate = appStore.getState().altrpPageState.getData();\r\n  context.altrpresponses = appStore.getState().altrpresponses.getData();\r\n  context.altrpmeta = appStore.getState().altrpMeta.getData();\r\n  return context;\r\n}\r\n\r\n/**\r\n *\r\n * Определеят явлется ли строка валидным JSON\r\n * @param {string} JSONString\r\n * @return {boolean}\r\n */\r\nexport function isJSON(JSONString = \"\") {\r\n  try {\r\n    JSON.parse(JSONString);\r\n    return true;\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n}\r\n\r\n/**\r\n * Парсит xml строку в объект\r\n * @param xml\r\n * @param arrayTags\r\n */\r\nfunction parseXml(xml, arrayTags) {\r\n  let dom = null;\r\n  if (window.DOMParser) dom = new DOMParser().parseFromString(xml, \"text/xml\");\r\n  else if (window.ActiveXObject) {\r\n    dom = new ActiveXObject(\"Microsoft.XMLDOM\");\r\n    dom.async = false;\r\n    if (!dom.loadXML(xml))\r\n      throw dom.parseError.reason + \" \" + dom.parseError.srcText;\r\n  } else throw new Error(\"cannot parse xml string!\");\r\n\r\n  function parseNode(xmlNode, result) {\r\n    if (xmlNode.nodeName === \"#text\") {\r\n      let v = xmlNode.nodeValue;\r\n      if (v.trim()) result[\"#text\"] = v;\r\n      return;\r\n    }\r\n\r\n    let jsonNode = {},\r\n      existing = result[xmlNode.nodeName];\r\n    if (existing) {\r\n      if (!Array.isArray(existing))\r\n        result[xmlNode.nodeName] = [existing, jsonNode];\r\n      else result[xmlNode.nodeName].push(jsonNode);\r\n    } else {\r\n      if (arrayTags && arrayTags.indexOf(xmlNode.nodeName) !== -1)\r\n        result[xmlNode.nodeName] = [jsonNode];\r\n      else result[xmlNode.nodeName] = jsonNode;\r\n    }\r\n\r\n    if (xmlNode.attributes)\r\n      for (let attribute of xmlNode.attributes)\r\n        jsonNode[attribute.nodeName] = attribute.nodeValue;\r\n\r\n    for (let node of xmlNode.childNodes) parseNode(node, jsonNode);\r\n  }\r\n\r\n  let result = {};\r\n  for (let node of dom.childNodes) parseNode(node, result);\r\n\r\n  return result;\r\n}\r\nfunction escapeRegExp(string) {\r\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"); // $& means the whole matched string\r\n}\r\n\r\n/**\r\n * Вернуть значение из строки\r\n * @param string\r\n */\r\nexport function parseStringValue(string) {\r\n  let value = string;\r\n\r\n  if (Number(value)) {\r\n    return Number(value);\r\n  }\r\n  switch (value) {\r\n    case \"true\": {\r\n      return true;\r\n    }\r\n    case \"false\": {\r\n      return false;\r\n    }\r\n    case \"null\": {\r\n      return null;\r\n    }\r\n    case \"undefined\": {\r\n      return undefined;\r\n    }\r\n    case \"0\": {\r\n      return 0;\r\n    }\r\n  }\r\n  return value;\r\n}\r\n\r\n/**\r\n *\r\n * @return {*[]}\r\n */\r\nexport function getBreadcrumbsItems(){\r\n  if(window['h-altrp'] && window.breadcrumbsItems){\r\n    return window.breadcrumbsItems;\r\n  }\r\n  let items = [];\r\n  if(isEditor(0)){\r\n    return items;\r\n  }\r\n  const currentId = window['h-altrp'] ? window.page_id : window.currentPageId\r\n  const {routes} = appStore.getState().appRoutes\r\n  let breadcrumbsClone = [];\r\n  let idCurrent = 0;\r\n  routes.forEach((route, idx) => {\r\n    if(currentId === route.id) {\r\n      idCurrent = idx\r\n    }\r\n  })\r\n\r\n  breadcrumbsClone.push(routes[idCurrent])\r\n\r\n  function getParent(parentId) {\r\n    routes.forEach(route => {\r\n      if(route.id === parentId) {\r\n        breadcrumbsClone.push(route)\r\n        if(route.parent_page_id) {\r\n          getParent(route.parent_page_id)\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  if(routes[idCurrent].parent_page_id) {\r\n    getParent(routes[idCurrent].parent_page_id)\r\n  }\r\n\r\n  items = breadcrumbsClone.reverse()\r\n  if(window['h-altrp']){\r\n    window.breadcrumbsItems = items;\r\n  }\r\n  return items;\r\n}\r\n","export const CHANGE_PAGE_STATE = 'CHANGE_PAGE_STATE';\r\nexport const CLEAR_PAGE_STATE = 'CLEAR_PAGE_STATE';\r\n\r\n/**\r\n *\r\n * @param {string}stateName\r\n * @param {*} stateValue\r\n * @return {{}} -\r\n *   {\r\n *     type: {string},\r\n *     stateValue: {},\r\n *     stateName: {string},\r\n *   }\r\n */\r\nexport function changePageState(stateName, stateValue = {}) {\r\n  return {\r\n    type: CHANGE_PAGE_STATE,\r\n    stateName,\r\n    stateValue\r\n  };\r\n}\r\n/**\r\n * Очищает состояние страницы\r\n */\r\nexport function clearPageState() {\r\n  return {\r\n    type: CLEAR_PAGE_STATE,\r\n  };\r\n}\r\n","export const CHANGE_CURRENT_USER = 'CHANGE_CURRENT_USER';\r\nexport const SET_NOTICE_FOR_USER = 'SET_NOTICE_FOR_USER';\r\nexport const SET_USERS_ONLINE = 'SET_USERS_ONLINE';\r\nexport const CHANGE_CURRENT_USER_PROPERTY = \"CHANGE_CURRENT_USER_PROPERTY\";\r\n\r\nexport function changeCurrentUser(user) {\r\n  return {\r\n    type: CHANGE_CURRENT_USER,\r\n    user: user || {}\r\n  };\r\n}\r\n\r\nexport function setUserNotice(notice){\r\n  return { type: SET_NOTICE_FOR_USER, notice }\r\n}\r\n\r\nexport function setUsersOnline(members){\r\n  return { type: SET_USERS_ONLINE, members }\r\n}\r\n\r\nexport function changeCurrentUserProperty(path, value) {\r\n  return {\r\n    type: CHANGE_CURRENT_USER_PROPERTY,\r\n    path: path || \"\",\r\n    value: value || \"\"\r\n  };\r\n}\r\n","export const ADD_RESPONSE_DATA = 'ADD_RESPONSE_DATA';\r\nexport const CLEAR_ALL_RESPONSE_DATA = 'CLEAR_ALL_RESPONSE_DATA';\r\n\r\n/**\r\n * Сохраняет ответ сервера при отправке формы в хранилище\r\n * @param {string}formId\r\n * @param {{}} data\r\n * @return {{}} -\r\n *   {\r\n *     type: {string},\r\n *     dataStorage: {object},\r\n *     dataStorageName: {string},\r\n *   }\r\n */\r\nexport function addResponseData(formId, data = {}) {\r\n  if(data.data) {\r\n    data = data.data;\r\n  }\r\n  return {\r\n    type: ADD_RESPONSE_DATA,\r\n    data,\r\n    formId\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * Очищает хранилище\r\n * @return {{type: string}}\r\n */\r\nexport function clearAllResponseData(){\r\n  return {\r\n    type: CLEAR_ALL_RESPONSE_DATA,\r\n  };\r\n}\r\n\r\n"],"sourceRoot":""}