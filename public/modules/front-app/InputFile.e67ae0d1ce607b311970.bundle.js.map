{"version":3,"sources":["webpack:///./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///./node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./resources/modules/editor/src/js/components/widgets/InputFileWidget.js","webpack:///./resources/modules/front-app/src/js/classes/AltrpFile.js","webpack:///./resources/modules/front-app/src/js/store/forms-data-storage/actions.js"],"names":["_assertThisInitialized","self","ReferenceError","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_inherits","subClass","superClass","TypeError","prototype","create","constructor","_possibleConstructorReturn","call","_setPrototypeOf","p","_typeof","Symbol","iterator","window","altrpHelpers","isEditor","parseOptionsFromSettings","replaceContentWithData","getDataFromLocalStorage","FileInput","altrpLibs","Blueprint","globalDefaults","push","InputFileWidget","props","getValue","formId","element","getFormId","fieldName","getFieldId","state","_","get","appStore","getState","onChange","e","setState","notActive","filesStorage","isArray","Promise","all","map","file","deleteFileFromStorage","console","error","files","target","limit","getResponsiveSetting","idx","AltrpFile","slice","storeFile","getProperty","dispatchFieldValueToStore","Math","random","forEach","reader","FileReader","readAsDataURL","onload","result","userInput","indexOf","isObject","dispatch","changeFormFieldValue","change_actions","getSettings","actionsManager","default","callAllWidgetActions","getIdForAction","component","elementDecorator","wrapperRef","React","createRef","defaultValue","getContent","settings","imageUrls_0","altrpSelectRef","this","prevProps","prevState","options","currentModel","contentLoaded","currentDataStorage","content_options","model_for_options","isEqual","dynamic","updateValue","content_calculation","altrpforms","formsStore","prevContext","altrpdata","getData","altrpmodel","altrpuser","currentUser","altrppagestate","altrpPageState","altrpresponses","altrpmeta","altrpMeta","context","getCurrentModel","currentDataStorageLoaded","changedField","altrpstorage","replace","eval","message","getId","path","text","disabled","inputProps","name","getName","accept","multiple","getFileName","join","fileInputProps","className","buttonText","onInputChange","style","backgroundImage","pointerEvents","ref","Component","data","File","Error","type","setProperty","getResource","postFiles","getFile","response","id","delete","resource","Resource","route","AltrpModel","CHANGE_FORM_FIELD_VALUE","CLEAR_FORM_FIELD_VALUE"],"mappings":"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","file":"InputFile.e67ae0d1ce607b311970.bundle.js","sourcesContent":["export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import _typeof from \"@babel/runtime/helpers/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import AltrpFile from \"../../../../../front-app/src/js/classes/AltrpFile\";\r\n\r\nconst {\r\n  isEditor,\r\n  parseOptionsFromSettings,\r\n  replaceContentWithData,\r\n  getDataFromLocalStorage\r\n} = window.altrpHelpers;\r\nimport {changeFormFieldValue} from \"../../../../../front-app/src/js/store/forms-data-storage/actions\";\r\n\r\nconst FileInput = window.altrpLibs.Blueprint.FileInput;\r\n\r\n(window.globalDefaults = window.globalDefaults || []).push(`\r\n.altrp-widget_input-file .bp3-file-upload-input::after{\r\n  width: auto;\r\n  min-width: 0;\r\n}\r\n.bp3-file-input_preview.bp3-file-input_preview{\r\n  background-repeat: no-repeat;\r\n  background-size: contain;\r\n  background-position: center;\r\n  width: 100px;\r\n  height: 100px;\r\n}\r\n`)\r\n\r\nclass InputFileWidget extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    props.element.component = this;\r\n    if (window.elementDecorator) {\r\n      window.elementDecorator(this);\r\n    }\r\n    this.wrapperRef = React.createRef()\r\n    this.defaultValue = this.getContent(\"content_default_value\");\r\n\r\n    this.state = {\r\n      settings: {...props.element.getSettings()},\r\n      value: this.defaultValue,\r\n      imageUrls_0: _.get(props.element.getResponsiveSetting('preview_placeholder'), 'url'),\r\n    };\r\n    this.altrpSelectRef = React.createRef();\r\n    if (this.getContent(\"content_default_value\")) {\r\n      this.dispatchFieldValueToStore(this.defaultValue);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Чистит значение\r\n   */\r\n  clearValue() {\r\n    this.onChange(null);\r\n    this.dispatchFieldValueToStore(null, true);\r\n  }\r\n\r\n\r\n  /**\r\n   *\r\n   * @returns {string | []}\r\n   */\r\n  getValue = () => {\r\n    let value;\r\n    let formId = this.props.element.getFormId();\r\n    let fieldName = this.props.element.getFieldId();\r\n    if (isEditor()) {\r\n      value = this.state.value;\r\n    } else {\r\n      value = _.get(appStore.getState(), `formsStore.${formId}.${fieldName}`, '')\r\n    }\r\n    return value;\r\n  }\r\n\r\n  /**\r\n   * Загрузка виджета\r\n   * @param {{}} prevProps\r\n   * @param {{}} prevState\r\n   */\r\n  async _componentDidMount(prevProps, prevState) {\r\n    if (this.props.element.getSettings(\"content_options\")) {\r\n      let options = parseOptionsFromSettings(\r\n        this.props.element.getSettings(\"content_options\")\r\n      );\r\n\r\n      this.setState(state => ({...state, options}));\r\n    }\r\n\r\n    let value = this.state.value;\r\n\r\n    /**\r\n     * Если динамическое значение загрузилось,\r\n     * то используем this.getContent для получение этого динамического значения\r\n     * старые динамические данные\r\n     * */\r\n    if (\r\n      _.get(value, \"dynamic\") &&\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\")\r\n    ) {\r\n      value = this.getContent(\"content_default_value\");\r\n    }\r\n\r\n    /**\r\n     * Если модель обновилась при смене URL\r\n     */\r\n    if (\r\n      prevProps &&\r\n      !prevProps.currentModel.getProperty(\"altrpModelUpdated\") &&\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\")\r\n    ) {\r\n      value = this.getContent(\"content_default_value\");\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (\r\n      this.props.currentModel.getProperty(\"altrpModelUpdated\") &&\r\n      this.props.currentDataStorage.getProperty(\"currentDataStorageLoaded\") &&\r\n      !this.state.contentLoaded\r\n    ) {\r\n      value = this.getContent(\"content_default_value\");\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (this.state.value !== value) {\r\n      this.setState(\r\n        state => ({...state, value}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Обновление виджета\r\n   */\r\n  async _componentDidUpdate(prevProps, prevState) {\r\n    const {content_options, model_for_options} = this.state.settings;\r\n    if (!this.getValue() && this.state.imageUrls_0 !== _.get(this.props.element.getResponsiveSetting('preview_placeholder'), 'url')) {\r\n      this.setState(\r\n        state => ({...state, imageUrls_0: _.get(this.props.element.getResponsiveSetting('preview_placeholder'), 'url')})\r\n      )\r\n    }\r\n    if (\r\n      prevProps &&\r\n      !prevProps.currentDataStorage.getProperty(\"currentDataStorageLoaded\") &&\r\n      this.props.currentDataStorage.getProperty(\"currentDataStorageLoaded\")\r\n    ) {\r\n      let value = this.getContent(\r\n        \"content_default_value\",\r\n        this.props.element.getSettings(\"select2_multiple\")\r\n      );\r\n      this.setState(\r\n        state => ({...state, value, contentLoaded: true}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    }\r\n\r\n    /**\r\n     * Если обновилась модель, то пробрасываем в стор новое значение (старый источник диамических данных)\r\n     */\r\n    if (\r\n      !_.isEqual(this.props.currentModel, prevProps.currentModel) &&\r\n      this.state.value &&\r\n      this.state.value.dynamic\r\n    ) {\r\n      this.dispatchFieldValueToStore(this.getContent(\"content_default_value\"));\r\n    }\r\n\r\n    if (content_options && !model_for_options) {\r\n      let options = parseOptionsFromSettings(content_options);\r\n      if (!_.isEqual(options, this.state.options)) {\r\n        this.setState(state => ({...state, options}));\r\n      }\r\n    }\r\n    this.updateValue(prevProps);\r\n  }\r\n\r\n  /**\r\n   * Обновить значение если нужно\r\n   * @param {{}} prevProps\r\n   */\r\n  updateValue(prevProps) {\r\n\r\n    if (isEditor()) {\r\n      return;\r\n    }\r\n\r\n    let content_calculation = this.props.element.getSettings(\r\n      \"content_calculation\"\r\n    );\r\n    const altrpforms = this.props.formsStore;\r\n    const fieldName = this.props.element.getFieldId();\r\n    const formId = this.props.element.getFormId();\r\n\r\n    if (!content_calculation) {\r\n      /**\r\n       * Обновить значение, если formsStore изменилось из другого компонента\r\n       */\r\n      const path = `${formId}.${fieldName}`;\r\n      if (\r\n        this.props.formsStore !== prevProps.formsStore &&\r\n        _.get(altrpforms, path) !== this.state.value\r\n      ) {\r\n        this.setState(state => ({\r\n          ...state,\r\n          value: _.get(altrpforms, path)\r\n        }));\r\n      }\r\n      return;\r\n    }\r\n\r\n    const prevContext = {};\r\n    const altrpdata = this.props.currentDataStorage.getData();\r\n    const altrpmodel = this.props.currentModel.getData();\r\n    const altrpuser = this.props.currentUser.getData();\r\n    const altrppagestate = this.props.altrpPageState.getData();\r\n    const altrpresponses = this.props.altrpresponses.getData();\r\n    const altrpmeta = this.props.altrpMeta.getData();\r\n    const context = this.props.element.getCurrentModel().getData();\r\n\r\n    if (content_calculation.indexOf(\"altrpdata\") !== -1) {\r\n      context.altrpdata = altrpdata;\r\n      if (!altrpdata.currentDataStorageLoaded) {\r\n        prevContext.altrpdata = altrpdata;\r\n      } else {\r\n        prevContext.altrpdata = prevProps.currentDataStorage.getData();\r\n      }\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpforms\") !== -1) {\r\n      context.altrpforms = altrpforms;\r\n      /**\r\n       * Не производим вычисления, если изменилось текущее поле\r\n       */\r\n      if (`${formId}.${fieldName}` === altrpforms.changedField) {\r\n        prevContext.altrpforms = altrpforms;\r\n      } else {\r\n        prevContext.altrpforms = prevProps.formsStore;\r\n      }\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpmodel\") !== -1) {\r\n      context.altrpmodel = altrpmodel;\r\n      prevContext.altrpmodel = prevProps.currentModel.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpuser\") !== -1) {\r\n      context.altrpuser = altrpuser;\r\n      prevContext.altrpuser = prevProps.currentUser.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpuser\") !== -1) {\r\n      context.altrpuser = altrpuser;\r\n      prevContext.altrpuser = prevProps.currentUser.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrppagestate\") !== -1) {\r\n      context.altrppagestate = altrppagestate;\r\n      prevContext.altrppagestate = prevProps.altrpPageState.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpmeta\") !== -1) {\r\n      context.altrpmeta = altrpmeta;\r\n      prevContext.altrpmeta = prevProps.altrpMeta.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpresponses\") !== -1) {\r\n      context.altrpresponses = altrpresponses;\r\n      prevContext.altrpresponses = prevProps.altrpresponses.getData();\r\n    }\r\n\r\n    if (content_calculation.indexOf(\"altrpstorage\") !== -1) {\r\n      context.altrpstorage = getDataFromLocalStorage(\"altrpstorage\", {});\r\n    }\r\n\r\n    if (\r\n      _.isEqual(prevProps.currentDataStorage, this.props.currentDataStorage) &&\r\n      _.isEqual(prevProps.currentUser, this.props.currentUser) &&\r\n      _.isEqual(prevProps.formsStore, this.props.formsStore) &&\r\n      _.isEqual(prevProps.altrpPageState, this.props.altrpPageState) &&\r\n      _.isEqual(prevProps.altrpMeta, this.props.altrpMeta) &&\r\n      _.isEqual(prevProps.altrpresponses, this.props.altrpresponses) &&\r\n      _.isEqual(prevProps.currentModel, this.props.currentModel)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      !_.isEqual(prevProps.formsStore, this.props.formsStore) &&\r\n      `${formId}.${fieldName}` === altrpforms.changedField\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    let value = \"\";\r\n\r\n    try {\r\n      content_calculation = content_calculation\r\n        .replace(/}}/g, \"')\")\r\n        .replace(/{{/g, \"_.get(context, '\");\r\n      value = eval(content_calculation);\r\n      if (value === this.state.value) {\r\n        return;\r\n      }\r\n      this.setState(\r\n        state => ({...state, value}),\r\n        () => {\r\n          this.dispatchFieldValueToStore(value);\r\n        }\r\n      );\r\n    } catch (e) {\r\n      console.error(\r\n        \"Evaluate error in Input \" + e.message,\r\n        this.props.element.getId()\r\n      );\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Изменение значения в виджете\r\n   * @param e\r\n   */\r\n  onChange = async (e) => {\r\n    this.setState(state => ({...state, notActive: true}))\r\n    const {filesStorage} = this.state;\r\n    try {\r\n      if(_.isArray(filesStorage))\r\n      {\r\n        await Promise.all(filesStorage.map(async file=>(await file.deleteFileFromStorage())))\r\n      }\r\n    }catch (e) {\r\n      console.error(e);\r\n    }\r\n    const files = e.target.files;\r\n    const limit = this.props.element.getResponsiveSetting('limit');\r\n    let value;\r\n    if (this.props.element.getResponsiveSetting('multiple')) {\r\n      value = _.map(files, (file, idx) => {\r\n        return new AltrpFile(file)\r\n      })\r\n      if(limit){\r\n        value = value.slice(0, limit)\r\n      }\r\n      this.setState(state=>({...state, filesStorage: value}))\r\n      try {\r\n        value = await Promise.all(value.map(async file => ((await file.storeFile()).getProperty('media.id'))))\r\n      }catch (e) {\r\n        console.error(e);\r\n      }\r\n    } else {\r\n      value = new AltrpFile(files[0])\r\n      this.setState(state=>({...state, filesStorage: [value]}))\r\n      try {\r\n        value = (await value.storeFile()).getProperty('media.id')\r\n      }catch (e) {\r\n        console.error(e);\r\n      }\r\n    }\r\n\r\n    if (isEditor()) {\r\n      this.setState(state => ({...state, value}))\r\n    } else {\r\n      this.dispatchFieldValueToStore(value, true)\r\n    }\r\n    this.setState(state => ({...state, key: Math.random()}))\r\n    try {\r\n      _.forEach(files, (file, idx) => {\r\n        if(limit && idx >= limit){\r\n          return\r\n        }\r\n        const reader = new FileReader\r\n        reader.readAsDataURL(file)\r\n        reader.onload = () => {\r\n          this.setState(state => {\r\n              state[`imageUrls_${idx}`] = reader.result;\r\n              return {...state};\r\n            }\r\n          )\r\n        }\r\n      })\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    this.setState(state => ({...state, notActive: false}))\r\n\r\n  }\r\n\r\n  /**\r\n   * Передадим значение в хранилище формы\r\n   * @param {*} value\r\n   * @param {boolean} userInput true - имзенилось пользователем\r\n   */\r\n  dispatchFieldValueToStore = async (value, userInput = false) => {\r\n    let formId = this.props.element.getFormId();\r\n    let fieldName = this.props.element.getFieldId();\r\n\r\n    if (fieldName.indexOf(\"{{\") !== -1) {\r\n      fieldName = replaceContentWithData(fieldName);\r\n    }\r\n    if (_.isObject(this.props.appStore) && fieldName && formId) {\r\n      this.props.appStore.dispatch(\r\n        changeFormFieldValue(fieldName, value, formId, userInput)\r\n      );\r\n\r\n      if (userInput) {\r\n        const change_actions = this.props.element.getSettings(\"change_actions\");\r\n\r\n        if (change_actions && !isEditor()) {\r\n          const actionsManager = (\r\n            await import(\r\n              /* webpackChunkName: 'ActionsManager' */\r\n              \"../../../../../front-app/src/js/classes/modules/ActionsManager.js\"\r\n              )\r\n          ).default;\r\n          await actionsManager.callAllWidgetActions(\r\n            this.props.element.getIdForAction(),\r\n            \"change\",\r\n            change_actions,\r\n            this.props.element\r\n          );\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n\r\n  /**\r\n   * Взовращает имя для атрибута name\r\n   * @return {string}\r\n   */\r\n  getName() {\r\n    return `${this.props.element.getFormId()}[${this.props.element.getFieldId()}]`;\r\n  }\r\n\r\n  render() {\r\n    const {element} = this.props\r\n    let disabled = element.getResponsiveSetting('readonly');\r\n\r\n    const inputProps = {\r\n      name: this.getName(),\r\n      accept: element.getResponsiveSetting('accept'),\r\n      multiple: element.getResponsiveSetting('multiple'),\r\n    }\r\n    let text\r\n    const {filesStorage, notActive} = this.state\r\n    if(_.isArray(filesStorage)){\r\n      text = filesStorage.map(file => file.getFileName()).join(', ');\r\n    } else if(filesStorage instanceof AltrpFile) {\r\n      text = filesStorage.getFileName()\r\n    } else {\r\n      text = replaceContentWithData(element.getResponsiveSetting('placeholder'), element.getCurrentModel().getData())\r\n    }\r\n    const fileInputProps = {\r\n      disabled,\r\n      key: this.state.key,\r\n      inputProps,\r\n      text,\r\n      className: `${notActive ? 'pointer-event-none' : ''}`,\r\n      buttonText: replaceContentWithData(element.getResponsiveSetting('button_text'), element.getCurrentModel().getData()),\r\n      onInputChange: this.onChange\r\n    }\r\n    if (element.getResponsiveSetting('preview')) {\r\n      fileInputProps.style = {\r\n        backgroundImage: `url(${this.state.imageUrls_0})`,\r\n        pointerEvents : notActive ? 'none' : '',\r\n      }\r\n      fileInputProps.className = 'bp3-file-input_preview'\r\n    }\r\n    return (\r\n      <FileInput {...fileInputProps} ref={this.wrapperRef}/>\r\n    );\r\n\r\n  }\r\n\r\n}\r\n\r\nexport default InputFileWidget;\r\n","/**\r\n * @class AltrpFile\r\n */\r\nclass AltrpFile extends AltrpModel{\r\n  constructor(data) {\r\n    if(data instanceof File){\r\n      data = {file: data}\r\n    }\r\n    if(! data.file instanceof File){\r\n      throw new Error('Need a File instance in AltrpFile Constructor')\r\n    }\r\n    super(data);\r\n    if(data.file.type.indexOf('image') >= 0){\r\n      const reader = new FileReader\r\n      reader.onload = ()=>{\r\n        this.setProperty('dataAsUrl', reader.result)\r\n      }\r\n      reader.readAsDataURL(data.file)\r\n    }\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {Promise<AltrpFile>}\r\n   */\r\n  async storeFile(){\r\n    try {\r\n      let response = await AltrpFile.getResource().postFiles([this.getFile()])\r\n      this.setProperty('media', response[0])\r\n    }catch (e) {\r\n      console.error(e);\r\n    }\r\n    return this\r\n  }\r\n  /**\r\n   *\r\n   * @returns {Promise<AltrpFile>}\r\n   */\r\n  async deleteFileFromStorage(){\r\n    const id = this.getProperty('media.id');\r\n    if(! id){\r\n      return this\r\n    }\r\n    try {\r\n      let response = await AltrpFile.getResource().delete(id)\r\n      this.setProperty('media', null)\r\n    }catch (e) {\r\n      console.error(e);\r\n    }\r\n    return this\r\n  }\r\n\r\n  /**\r\n   * @return {File}\r\n   */\r\n  getFile(){\r\n    return this.getProperty('file')\r\n  }\r\n  getFileName(){\r\n    return this.getFile()?.name || ''\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {string}\r\n   */\r\n  toString(){\r\n    return this.getFileName()\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @returns {Resource}\r\n   */\r\n  static getResource(){\r\n    if(! AltrpFile.resource){\r\n      AltrpFile.resource = new window.altrpHelpers.Resource({route: '/ajax/media'})\r\n    }\r\n    return AltrpFile.resource\r\n  }\r\n}\r\n\r\nexport default AltrpFile\r\n","export const CHANGE_FORM_FIELD_VALUE = 'CHANGE_FORM_FIELD_VALUE';\nexport const CLEAR_FORM_FIELD_VALUE = 'CHANGE_FORM_FIELD_VALUE';\n\n/**\n * Получает данные поля формы и сохраняет в хранилище\n * @param {string}fieldName\n * @param {*}value\n * @param {string}formId\n * @param {boolean}userInput\n * @return {{type: string, fieldName: *, value: *, formId: *}}\n */\nexport function changeFormFieldValue(fieldName, value, formId, userInput) {\n  return {\n    type: CHANGE_FORM_FIELD_VALUE,\n    fieldName,\n    value,\n    formId,\n    changedField: userInput ? `${formId}.${fieldName}` : null,\n  };\n}\n/**\n * Очистить данные поля формы и сохраняет в хранилище\n * @param {string | null}formId\n * @return {{type: string, fieldName: *, value: *, formId: *}}\n */\nexport function clearFormStorage(formId = null) {\n  return {\n    type: CLEAR_FORM_FIELD_VALUE,\n    formId,\n  };\n}\n\n"],"sourceRoot":""}