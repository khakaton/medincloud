(self.webpackChunk=self.webpackChunk||[]).push([[2017],{30259:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(85061),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(96156),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(92137),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(6610),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(5991),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(63349),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(10379),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(46070),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(77608),_babel_runtime_helpers_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(32465),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(87757),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1__),_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(32543),_classes_Resource__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(38773),_admin_src_components_altrp_select_AltrpSelect__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4916),_front_app_src_js_store_forms_data_storage_actions__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(48379),_classes_AltrpModel__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(71743),_ckeditor_CKeditor__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(14114),_altrp_image_select_AltrpImageSelect__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(98356),_altrp_input_AltrpInput__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(4011),_templateObject;function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__.Z)(e);if(t){var a=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__.Z)(this,n)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var moment=window.altrpHelpers.moment;(window.globalDefaults=window.globalDefaults||[]).push('\n.altrp-field {\n  border-style: solid;\n  width: 100%;\n}\n.altrp-field-file{\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap;\n}\n\n.altrp-label-icon svg,\n.altrp-label-icon img {\n  width: 20px;\n}\n.altrp-label-icon svg{\n  height: 20px;\n}\n.altrp-field-file__field{\n  display: none;\n}\n.altrp-field-file__placeholder{\n  display: none;\n}\n.altrp-field-file_empty .altrp-field-file__placeholder{\n  display: block;\n  padding: 10px 20px;\n  border: none;\n  cursor: pointer;\n  background-color: rgb(52,59,76);\n  color: #fff;\n}\n.input-clear-btn {\n  background: transparent;\n  padding: 0;\n  position: absolute;\n  bottom: calc(50% - 7px);\n  right: 15px;\n  display: none;\n}\n.input-clear-btn:hover {\n  font-weight: bold;\n}\n.altrp-field:hover + .input-clear-btn, .input-clear-btn:hover {\n  display: block;\n}\n.altrp-input-wrapper, .altrp-field-select2 {\n  position: relative;\n  flex-grow: 1;\n}\n.altrp-field-label--required::after {\n  content: "*";\n  color: red;\n  font-size: inherit;\n  padding-left: 10px;\n}\n.altrp-field-label {\n  font-size: 16px;\n  font-family: "Open Sans";\n  line-height: 1.5;\n  letter-spacing: 0;\n}\n.altrp-field-select2__single-value, .altrp-field {\n  font-size: 16px;\n  font-family: "Open Sans";\n  line-height: 1.5;\n  letter-spacing: 0;\n}\n.altrp-field-select2__control, .altrp-field {\n  text-align: left;\n  padding-top: 2px;\n  padding-right: 2px;\n  padding-bottom: 2px;\n  padding-left: 2px;\n  border-width: 1px;\n  border-color: #000;\n}\n.altrp-field-select2__control:hover{\n  border-width: 1px;\n  border-color: #000;\n}\n.altrp-field-container {\n  margin: 0;\n}\n.altrp-field::placeholder, .altrp-field-select2__placeholder {\n  font-size: 13px;\n  font-family: "Open Sans";\n  line-height: 1.5;\n  letter-spacing: 0;\n}\n.altrp-image-select {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n}\n.altrp-image-select img {\n  flex-grow: 1;\n  object-fit: contain;\n}\n.altrp-field {\n  overflow: hidden;\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n.altrp-field.active {\n  border-color: lightcoral;\n}\n.altrp-field-label {\n  text-align: center;\n  display: block;\n}\n.altrp-pagination__select-size .altrp-field-select2__single-value {\n  font-size: 14px;\n}\n.altrp-pagination__select-size .altrp-field-select2__indicator-separator {\n  display: none;\n}\n.altrp-pagination__select-size .altrp-field-select2__indicator {\n  align-items: center;\n}\n.altrp-pagination__select-size .altrp-field-select2__control {\n  width: 100px;\n  min-height: 32px;\n  padding: 0;\n  border-radius: 0;\n  outline: none;\n  border-color: rgb(142,148,170);\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n}\n.altrp-pagination__select-size .altrp-field-select2__control input {\n  border: none;\n}\n.altrp-field-select2 {\n  position: relative;\n  box-sizing: border-box;\n  pointer-events: none;\n}\n.altrp-field-select2__control {\n  webkit-align-items: center;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  background-color: hsl(0,0%,100%);\n  border-color: hsl(0,0%,80%);\n  border-style: solid;\n  border-width: 1px;\n  cursor: default;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-flex-wrap: wrap;\n  -ms-flex-wrap: wrap;\n  flex-wrap: wrap;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n  -ms-flex-pack: justify;\n  justify-content: space-between;\n  min-height: 38px;\n  outline: 0 !important;\n  position: relative;\n  -webkit-transition: all 100ms;\n  transition: all 100ms;\n  box-sizing: border-box;\n}\n.altrp-field-select2__value-container {\n  -webkit-align-items: center;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-flex: 1;\n  -ms-flex: 1;\n  flex: 1;\n  -webkit-flex-wrap: wrap;\n  -ms-flex-wrap: wrap;\n  flex-wrap: wrap;\n  padding: 2px 8px;\n  -webkit-overflow-scrolling: touch;\n  position: relative;\n  overflow: hidden;\n  box-sizing: border-box;\n}\n.altrp-field-select2__single-value {\n  color: hsl(0,0%,20%);\n  margin-left: 2px;\n  margin-right: 2px;\n  max-width: calc(100% - 8px);\n  overflow: hidden;\n  position: absolute;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n  -ms-transform: translateY(-50%);\n  transform: translateY(-50%);\n  box-sizing: border-box;\n}\n.altrp-field-select2__indicators {\n  -webkit-align-items: center;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  -webkit-align-self: stretch;\n  -ms-flex-item-align: stretch;\n  align-self: stretch;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-flex-shrink: 0;\n  -ms-flex-negative: 0;\n  flex-shrink: 0;\n  box-sizing: border-box;\n}\n.altrp-field-select2__indicator-separator {\n  -webkit-align-self: stretch;\n  -ms-flex-item-align: stretch;\n  align-self: stretch;\n  background-color: hsl(0,0%,80%);\n  margin-bottom: 8px;\n  margin-top: 8px;\n  width: 1px;\n  box-sizing: border-box;\n}\n.altrp-field-select2__indicator {\n  color: hsl(0,0%,80%);\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 8px;\n  -webkit-transition: color 150ms;\n  transition: color 150ms;\n  box-sizing: border-box;\n  justify-content: center;\n  align-items: center;\n}\n.tba-placeholder {\n  display: flex;\n  justify-content: center;\n  font-size: 28px;\n  font-weight: bold;\n}\n.altrp-field-subgroup {\n  display: flex;\n  flex-wrap: wrap;\n}\n.altrp-field-option {\n  display: flex;\n  padding: 10px;\n}\n.altrp-field-option__label {\n  cursor: pointer;\n}\ntextarea.altrp-field {\n  display: block;\n}\n.altrp-table__filter-select .altrp-field-select2__placeholder {\n  white-space: nowrap;\n}\n.altrp-table__filter-select .altrp-field-select2__single-value {\n  font-size: 14px;\n}\n.altrp-table__filter-select .altrp-field-select2__indicator-separator {\n  display: none;\n}\n.altrp-table__filter-select .altrp-field-select2__indicator {\n  align-items: center;\n}\n.altrp-table__filter-select .altrp-field-select2__control {\n  width: 100%;\n  min-height: 19px;\n  padding: 0;\n  border-radius: 0;\n  outline: none;\n  border-color: rgb(142, 148, 170);\n  -webkit-box-shadow: none;\n  -moz-box-shadow: none;\n  box-shadow: none;\n}\n.altrp-table__filter-select .altrp-field-select2__control input {\n  border: none;\n}\n.altrp-table__filter-select .altrp-field-select2__value-container {\n  padding-top: 0;\n  padding-bottom: 0;\n  line-height: 13px;\n}\n.altrp-field-required {\n  color: red;\n  font-size: 18px;\n  padding-left: 10px;\n}\n.altrp-field-container-label {\n  display: flex;\n  flex-direction: row;\n}\n\n.altrp-field-label-container-left {\n  display: flex;\n  align-items: center;\n}\n\n.altrp-field-label-container {\n  display: inline-flex;\n  align-items: center;\n}\n.altrp-field-select2__indicator.altrp-field-select2__dropdown-indicator {\n  padding: 0 8px;\n  max-height: 14px;\n  overflow: hidden;\n}\n.altrp-field-select2 .altrp-field-select2__value-container {\n  padding: 0px 8px;\n}\n.altrp-field-select2 .css-b8ldur-Input {\n  padding-bottom: 0px;\n  padding-top: 0px;\n  margin: 0 2px;\n}\n.altrp-field-select2 .altrp-field-select2__control {\n  min-height: 14px;\n}\n');var AltrpFieldContainer=styled.div(_templateObject||(_templateObject=(0,_babel_runtime_helpers_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_11__.Z)(["\n  ","\n"])),(function(e){switch(e.settings.content_label_position_type){case"left":return"display: flex";case"right":return"display:flex;flex-direction:row-reverse;justify-content:flex-end;"}return""})),InputWidget=function(_Component){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_12__.Z)(InputWidget,_Component);var _super=_createSuper(InputWidget),_updateOptions,_componentDidUpdate2,_componentDidMount2;function InputWidget(e){var t;return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_13__.Z)(this,InputWidget),(t=_super.call(this,e)).timeInput=null,t.handleEnter=function(e){if(13===e.keyCode){e.preventDefault();var n=Array.from(document.querySelectorAll("input,select")),r=n.indexOf(e.target);if(void 0===r)return;n[r+1]&&n[r+1].focus();var a=t.props.element.getSettings(),_=a.create_allowed,s=a.create_label,l=a.create_url;_&&s&&l&&t.createItem(e)}},t.debounceDispatch=_.debounce((function(e){return t.dispatchFieldValueToStore(e,!0)}),150),t.onFocus=function(){var e=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark((function e(n){var r,a;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.props.element.getSettings("focus_actions"))||(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.isEditor)()){e.next=7;break}return e.next=4,__webpack_require__.e(6737).then(__webpack_require__.bind(__webpack_require__,2167));case 4:return a=e.sent.default,e.next=7,a.callAllWidgetActions(t.props.element.getIdForAction(),"focus",r,t.props.element);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.onBlur=function(){var e=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark((function e(n){var r,a,s=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:null,-1!==["text","email","phone","tel","number","password"].indexOf(t.state.settings.content_type)&&t.dispatchFieldValueToStore(n.target.value,!0),_.get(r,"getData")&&t.dispatchFieldValueToStore(r.getData(),!0),!t.props.element.getSettings("actions",[])||(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.isEditor)()){e.next=9;break}return e.next=6,__webpack_require__.e(6737).then(__webpack_require__.bind(__webpack_require__,2167));case 6:return a=e.sent.default,e.next=9,a.callAllWidgetActions(t.props.element.getIdForAction(),"blur",t.props.element.getSettings("actions",[]),t.props.element);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.dispatchFieldValueToStore=function(){var e=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark((function e(n){var r,a,s,l,i,o=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>1&&void 0!==o[1]&&o[1],a=t.props.element.getFormId(),-1!==(s=t.props.element.getFieldId()).indexOf("{{")&&(s=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.replaceContentWithData)(s)),!(_.isObject(t.props.appStore)&&s&&a)){e.next=14;break}if(t.props.appStore.dispatch((0,_front_app_src_js_store_forms_data_storage_actions__WEBPACK_IMPORTED_MODULE_15__.Az)(s,n,a,r)),!r){e.next=14;break}if(!(l=t.props.element.getSettings("change_actions"))||(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.isEditor)()){e.next=14;break}return e.next=11,__webpack_require__.e(6737).then(__webpack_require__.bind(__webpack_require__,2167));case 11:return i=e.sent.default,e.next=14,i.callAllWidgetActions(t.props.element.getIdForAction(),"change",l,t.props.element);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.createItem=function(){var e=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark((function e(n){var r,a,s,l,i,o,p,c,u,d,g,f,h;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.keyCode,a=n.target.value,13===r&&a){e.next=4;break}return e.abrupt("return");case 4:if(s=t.props.element.getSettings(),l=s.create_url,i=s.create_label,o=s.create_data,p=s.select2_multiple,i||l){e.next=7;break}return e.abrupt("return");case 7:return c=t.props.element.getCurrentModel(),(u=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.parseParamsFromString)(o,c,!0))[i]=a,d=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.parseURLTemplate)(l,c.getData()),t.setState((function(e){return _objectSpread(_objectSpread({},e),{},{isDisabled:!0})})),e.prev=12,g=new _classes_Resource__WEBPACK_IMPORTED_MODULE_5__.default({route:d}),e.next=16,g.post(u);case 16:(f=e.sent).success&&_.get(f,"data.id")&&(h={label:a,value:_.get(f,"data.id")},t.setState((function(e){return _objectSpread(_objectSpread({},e),{},{isDisabled:!1})}),(function(){var e=(0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_16__.Z)(t.state.options);e.unshift(h);var n=t.state.value;p?(n=n?(0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_16__.Z)(n):[]).push(_.get(f,"data.id")):n=_.get(f,"data.id"),t.setState((function(t){return _objectSpread(_objectSpread({},t),{},{options:e,value:n})}),(function(){var e=_.get((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__.Z)(t),"altrpSelectRef.current.selectRef.current");e&&e.setState({menuIsOpen:!1,inputValue:""})}))}))),t.setState((function(e){return _objectSpread(_objectSpread({},e),{},{isDisabled:!1})})),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(12),console.error(e.t0),t.setState((function(e){return _objectSpread(_objectSpread({},e),{},{isDisabled:!1})}));case 25:case"end":return e.stop()}}),e,null,[[12,21]])})));return function(t){return e.apply(this,arguments)}}(),e.element.component=(0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__.Z)(t),window.elementDecorator&&window.elementDecorator((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__.Z)(t)),t.onChange=t.onChange.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__.Z)(t)),t.debounceDispatch=t.debounceDispatch.bind((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_17__.Z)(t)),t.defaultValue=t.getContent("content_default_value")||(t.valueMustArray()?[]:""),t.valueMustArray()&&!_.isArray(t.defaultValue)&&(t.defaultValue=[]),t.state={settings:_objectSpread({},e.element.getSettings()),value:t.defaultValue,options:(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.parseOptionsFromSettings)(e.element.getSettings("content_options")),paramsForUpdate:null},t.altrpSelectRef=React.createRef(),t.getContent("content_default_value")&&t.dispatchFieldValueToStore(t.getContent("content_default_value")),t}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_18__.Z)(InputWidget,[{key:"valueMustArray",value:function(){return-1!==["file","image_select","checkbox"].indexOf(this.props.element.getSettings("content_type"))||!("select2"!==this.props.element.getSettings("content_type")||!this.props.element.getSettings("select2_multiple"))}},{key:"clearValue",value:function(){var e="";("checkbox"===this.props.element.getSettings("content_type")||["select2","image_select"].indexOf(this.props.element.getSettings("content_type"))>=0&&this.props.element.getSettings("select2_multiple"))&&(e=[]),this.onChange(e),this.dispatchFieldValueToStore(e,!0)}},{key:"selectAll",value:function(){var e=this.props.element.getDynamicSetting("content_options");if("checkbox"===this.props.element.getSettings("content_type")){var t=(0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_16__.Z)(this.state.options);e&&(t=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.convertData)(e,t)),t=t.map((function(e){return e.value})),this.onChange(t)}if(["select2","image_select"].indexOf(this.props.element.getSettings("content_type"))>=0&&this.props.element.getSettings("select2_multiple")){var n=(0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_16__.Z)(this.state.options);_.isArray(n)?e&&(n=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.convertData)(e,n)):n=[],this.onChange(n)}}},{key:"_componentDidMount",value:(_componentDidMount2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark((function e(t,n){var r,a,s,l=this;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.element.getSettings("content_options")){e.next=5;break}r=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.parseOptionsFromSettings)(this.props.element.getSettings("content_options")),this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{options:r})})),e.next=12;break;case 5:if(!(["select","select2"].indexOf(this.state.settings.content_type)>=0&&this.state.settings.model_for_options)){e.next=12;break}return e.next=8,new _classes_Resource__WEBPACK_IMPORTED_MODULE_5__.default({route:this.getRoute()}).getAll();case 8:a=e.sent,a=_.isArray(a)?a:a.data,a=_.isArray(a)?a:[],this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{options:a})}));case 12:if(s=this.state.value,_.get(s,"dynamic")&&this.props.currentModel.getProperty("altrpModelUpdated")&&(s=this.getContent("content_default_value")),!t||t.currentModel.getProperty("altrpModelUpdated")||!this.props.currentModel.getProperty("altrpModelUpdated")){e.next=18;break}return s=this.getContent("content_default_value"),this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{value:s,contentLoaded:!0})}),(function(){l.dispatchFieldValueToStore(s)})),e.abrupt("return");case 18:if(!this.props.currentModel.getProperty("altrpModelUpdated")||!this.props.currentDataStorage.getProperty("currentDataStorageLoaded")||this.state.contentLoaded){e.next=22;break}return s=this.getContent("content_default_value"),this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{value:s,contentLoaded:!0})}),(function(){l.dispatchFieldValueToStore(s)})),e.abrupt("return");case 22:this.state.value!==s&&this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{value:s})}),(function(){l.dispatchFieldValueToStore(s)}));case 23:case"end":return e.stop()}}),e,this)}))),function(e,t){return _componentDidMount2.apply(this,arguments)})},{key:"getRoute",value:function(){var e=this.props.element.getSettings("model_for_options");return-1===e.indexOf("/")?"/ajax/models/".concat(e,"_options"):(-1!==e.indexOf("{{")&&(e=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.replaceContentWithData)(e)),e)}},{key:"_componentDidUpdate",value:(_componentDidUpdate2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark((function e(t,n){var r,a,s,l,i,o,p,c=this;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.state.settings,a=r.content_options,s=r.model_for_options,t&&!t.currentDataStorage.getProperty("currentDataStorageLoaded")&&this.props.currentDataStorage.getProperty("currentDataStorageLoaded")&&(l=this.getContent("content_default_value",this.props.element.getSettings("select2_multiple")),this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{value:l,contentLoaded:!0})}),(function(){c.dispatchFieldValueToStore(l)}))),"select"!==this.props.element.getSettings("content_type")||!this.props.element.getSettings("model_for_options")){e.next=11;break}if(this.state.settings.model_for_options===t.element.getSettings("model_for_options")){e.next=11;break}return i=t.element.getSettings("model_for_options"),e.next=7,new _classes_Resource__WEBPACK_IMPORTED_MODULE_5__.default({route:this.getRoute()}).getAll();case 7:o=e.sent,o=_.isArray(o)?o:o.data,o=_.isArray(o)?o:[],this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{options:o,model_for_options:i})}));case 11:!_.isEqual(this.props.currentModel,t.currentModel)&&this.state.value&&this.state.value.dynamic&&this.dispatchFieldValueToStore(this.getContent("content_default_value")),this.props.formsStore===t.formsStore&&this.props.currentModel===t.currentModel&&this.props.currentDataStorage===t.currentDataStorage||this.updateOptions(),a&&!s&&(p=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.parseOptionsFromSettings)(a),_.isEqual(p,this.state.options)||this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{options:p})}))),this.updateValue(t);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return _componentDidUpdate2.apply(this,arguments)})},{key:"updateValue",value:function updateValue(prevProps){var _this4=this;if(!(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.isEditor)()){var content_calculation=this.props.element.getSettings("content_calculation"),altrpforms=this.props.formsStore,fieldName=this.props.element.getFieldId(),formId=this.props.element.getFormId();if(content_calculation){var prevContext={},altrpdata=this.props.currentDataStorage.getData(),altrpmodel=this.props.currentModel.getData(),altrpuser=this.props.currentUser.getData(),altrppagestate=this.props.altrpPageState.getData(),altrpresponses=this.props.altrpresponses.getData(),altrpmeta=this.props.altrpMeta.getData(),context=this.props.element.getCurrentModel().getData();if(-1!==content_calculation.indexOf("altrpdata")&&(context.altrpdata=altrpdata,altrpdata.currentDataStorageLoaded?prevContext.altrpdata=prevProps.currentDataStorage.getData():prevContext.altrpdata=altrpdata),-1!==content_calculation.indexOf("altrpforms")&&(context.altrpforms=altrpforms,"".concat(formId,".").concat(fieldName)===altrpforms.changedField?prevContext.altrpforms=altrpforms:prevContext.altrpforms=prevProps.formsStore),-1!==content_calculation.indexOf("altrpmodel")&&(context.altrpmodel=altrpmodel,prevContext.altrpmodel=prevProps.currentModel.getData()),-1!==content_calculation.indexOf("altrpuser")&&(context.altrpuser=altrpuser,prevContext.altrpuser=prevProps.currentUser.getData()),-1!==content_calculation.indexOf("altrpuser")&&(context.altrpuser=altrpuser,prevContext.altrpuser=prevProps.currentUser.getData()),-1!==content_calculation.indexOf("altrppagestate")&&(context.altrppagestate=altrppagestate,prevContext.altrppagestate=prevProps.altrpPageState.getData()),-1!==content_calculation.indexOf("altrpmeta")&&(context.altrpmeta=altrpmeta,prevContext.altrpmeta=prevProps.altrpMeta.getData()),-1!==content_calculation.indexOf("altrpresponses")&&(context.altrpresponses=altrpresponses,prevContext.altrpresponses=prevProps.altrpresponses.getData()),-1!==content_calculation.indexOf("altrpstorage")&&(context.altrpstorage=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.getDataFromLocalStorage)("altrpstorage",{})),!(_.isEqual(prevProps.currentDataStorage,this.props.currentDataStorage)&&_.isEqual(prevProps.currentUser,this.props.currentUser)&&_.isEqual(prevProps.formsStore,this.props.formsStore)&&_.isEqual(prevProps.altrpPageState,this.props.altrpPageState)&&_.isEqual(prevProps.altrpMeta,this.props.altrpMeta)&&_.isEqual(prevProps.altrpresponses,this.props.altrpresponses)&&_.isEqual(prevProps.currentModel,this.props.currentModel))&&(_.isEqual(prevProps.formsStore,this.props.formsStore)||"".concat(formId,".").concat(fieldName)!==altrpforms.changedField)){var value="";try{if(content_calculation=content_calculation.replace(/}}/g,"')").replace(/{{/g,"_.get(context, '"),value=eval(content_calculation),value===this.state.value)return;this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{value:value})}),(function(){_this4.dispatchFieldValueToStore(value)}))}catch(e){console.error("Evaluate error in Input "+e.message,this.props.element.getId())}}}else{var path="".concat(formId,".").concat(fieldName);this.props.formsStore!==prevProps.formsStore&&_.get(altrpforms,path)!==this.state.value&&this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{value:_.get(altrpforms,path)})}))}}}},{key:"updateOptions",value:(_updateOptions=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().mark((function e(){var t,n,r,a;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.element.getFormId(),n=this.props.element.getSettings("params_for_update"),r=_.get(this.props.formsStore,[t],{}),n=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.parseParamsFromString)(n,new _classes_AltrpModel__WEBPACK_IMPORTED_MODULE_7__.Z(r)),a=(0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_16__.Z)(this.state.options),_.isEqual(n,this.state.paramsForUpdate)){e.next=28;break}if(_.isEmpty(n)){e.next=21;break}if(!this.props.element.getSettings("params_as_filters",!1)){e.next=14;break}return n=JSON.stringify(n),e.next=11,new _classes_Resource__WEBPACK_IMPORTED_MODULE_5__.default({route:this.getRoute()}).getQueried({filters:n});case 11:a=e.sent,e.next=17;break;case 14:return e.next=16,new _classes_Resource__WEBPACK_IMPORTED_MODULE_5__.default({route:this.getRoute()}).getQueried(n);case 16:a=e.sent;case 17:a=_.isArray(a)?a:a.data,a=_.isArray(a)?a:[],e.next=27;break;case 21:if(!this.state.paramsForUpdate){e.next=27;break}return e.next=24,new _classes_Resource__WEBPACK_IMPORTED_MODULE_5__.default({route:this.getRoute()}).getAll();case 24:a=e.sent,a=_.isArray(a)?a:a.data,a=_.isArray(a)?a:[];case 27:this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{paramsForUpdate:n,options:a})}));case 28:case"end":return e.stop()}}),e,this)}))),function(){return _updateOptions.apply(this,arguments)})},{key:"onChange",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a="",s=this.props.element.getSettings();if(e&&e.target)if("checkbox"===this.props.element.getSettings("content_type")){var l=document.getElementsByName(e.target.name);a=[],l.forEach((function(e){e.checked&&a.push(e.value)}))}else if("accept"===s.content_type){var i=e.target.checked,o=this.props.element.getSettings("accept_checked")||!0,p=this.props.element.getSettings("accept_unchecked")||!1;p=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.valueReplacement)(p),o=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.valueReplacement)(o),t=i?o:p}else a=e.target.value;e&&e.value&&(a=e.value),_.get(r,"getData")&&(a='<div class="ck ck-content" style="width:100%">'.concat(r.getData(),"</div>")),_.isArray(e)&&(a=_.cloneDeep(e)),"select2"===this.props.element.getSettings("content_type")&&(this.props.element.getSettings("select2_multiple",!1)&&!e&&(a=[]),this.props.element.getSettings("select2_multiple",!1)&&(a=a.map((function(e){return e.value})))),this.props.element.getSettings("content_options_nullable")&&e&&"<null>"===e.value&&(a=null);var c=this.props.element.getSettings("content_timestamp"),u="date"===this.state.settings.content_type;u&&c&&""!=a&&(a=new Date(a).getTime()),this.setState((function(e){return _objectSpread(_objectSpread({},e),{},{value:a})}),(function(){var e=n.props.element.getSettings("change_actions"),r=n.props.element.getSettings("change_change_end"),_=n.props.element.getSettings("change_change_end_delay");-1===["text","email","phone","tel","number","password"].indexOf(n.state.settings.content_type)&&n.dispatchFieldValueToStore(void 0!==t?t:a,!0),!e||r||(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.isEditor)()||n.debounceDispatch(void 0!==t?t:a),e&&r&&!(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.isEditor)()&&(n.timeInput&&clearTimeout(n.timeInput),n.timeInput=setTimeout((function(){n.debounceDispatch(void 0!==t?t:a)}),_))}))}},{key:"getOptions",value:function(){var e=(0,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_16__.Z)(this.state.options),t=this.props.element.getDynamicSetting("content_options");return t&&(e=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.convertData)(t,e)),this.props.element.getSettings("sort_default")||(e=_.sortBy(e,(function(e){return e&&(e.label?e.label.toString():e)}))),e}},{key:"getName",value:function(){return"".concat(this.props.element.getFormId(),"[").concat(this.props.element.getFieldId(),"]")}},{key:"render",value:function(){var e,t=this,n=this.props.element.getSettings(),r=n.options_sorting,a=n.content_readonly,s=n.image_select_options,l=n.select2_multiple,i=n.label_icon,o=this.state.value;_.get(o,"dynamic")&&this.props.currentModel.getProperty("altrpModelUpdated")&&(o=this.getContent("content_default_value")),o&&o.dynamic&&(o="");var p="",c={},u=this.props.element.getResponsiveSetting("content_label_position_type");switch(u){case"top":c={marginBottom:this.state.settings.label_style_spacing?this.state.settings.label_style_spacing.size+this.state.settings.label_style_spacing.unit:"2px"},p="";break;case"bottom":c={marginTop:this.state.settings.label_style_spacing?this.state.settings.label_style_spacing.size+this.state.settings.label_style_spacing.unit:"2px"},p="";break;case"left":c={marginRight:this.state.settings.label_style_spacing?this.state.settings.label_style_spacing.size+this.state.settings.label_style_spacing.unit:"2px"},p="altrp-field-label-container-left";break;case"absolute":c={position:"absolute",zIndex:2},p=""}e=this.state.settings.content_label?React.createElement("div",{className:"altrp-field-label-container "+p,style:c},React.createElement("label",{className:"altrp-field-label ".concat(this.state.settings.content_required?"altrp-field-label--required":"")},this.state.settings.content_label),i&&i.assetType&&React.createElement("span",{className:"altrp-label-icon"},(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.renderAssetIcon)(i))):null;var d;d=this.state.settings.content_autocomplete?"on":"off";var g=null;switch(this.state.settings.content_type){case"select":var f=this.getOptions();g=React.createElement("select",{value:o||"",onFocus:this.onFocus,name:this.getName(),onChange:this.onChange,onBlur:this.onBlur,onKeyDown:this.handleEnter,id:this.state.settings.position_css_id,className:"altrp-field "+this.state.settings.position_css_classes},this.state.settings.content_options_nullable?React.createElement("option",{value:""}):"",(r?(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.sortOptions)(f,r):f).map((function(e){return React.createElement("option",{value:e.value,key:e.value},e.label)})));break;case"select2":g=this.renderSelect2();break;case"radio":case"checkbox":g=this.renderRepeatedInput();break;case"wysiwyg":g=this.renderWysiwyg();break;case"textarea":g=React.createElement("textarea",{value:o||"",readOnly:a,autoComplete:d,placeholder:this.state.settings.content_placeholder,className:"altrp-field "+this.state.settings.position_css_classes,onChange:this.onChange,onBlur:this.onBlur,id:this.state.settings.position_css_id});break;case"image_select":g=React.createElement(_altrp_image_select_AltrpImageSelect__WEBPACK_IMPORTED_MODULE_9__.Z,{options:s,value:this.state.value,changeHandler:function(e){return t.setState({value:e})},isMultiple:l});break;case"accept":g=this.renderAcceptInput();break;default:var h=this.state.settings.content_clearable,m="date"===this.state.settings.content_type,b=this.props.element.getSettings("content_timestamp");if(m&&b&&moment.unix(o).isValid())try{o=moment.unix(o/1e3).format("YYYY-MM-DD")}catch(e){console.log(e)}g=React.createElement("div",{className:"altrp-input-wrapper"},React.createElement(_altrp_input_AltrpInput__WEBPACK_IMPORTED_MODULE_10__.Z,{type:this.state.settings.content_type,name:this.getName(),value:o||"",element:this.props.element,readOnly:a,autoComplete:d,placeholder:this.state.settings.content_placeholder,className:"altrp-field "+this.state.settings.position_css_classes,settings:this.props.element.getSettings(),onKeyDown:this.handleEnter,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,id:this.state.settings.position_css_id}),h&&React.createElement("button",{className:"input-clear-btn",onClick:function(){return t.setState({value:t.defaultValue})}},"✖"))}return React.createElement(AltrpFieldContainer,{settings:n,className:"image_select"!==this.state.settings.content_type?"altrp-field-container ":""+p},"top"===u?e:"","left"===u?e:"","right"===u?e:"","absolute"===u?e:"",g,"bottom"===u?e:"")}},{key:"renderAcceptInput",value:function(){this.props.element.getSettings();var e=this.state.value,t=this.props.element.getSettings("accept_checked")||!0,n=this.props.element.getSettings("accept_unchecked")||!1;return e===t?e=!0:e===n&&(e=!1),React.createElement("div",{className:"altrp-field-option ".concat(e?"active":"")},React.createElement("span",{className:"altrp-field-option-span"},React.createElement("input",{type:"checkbox",name:"".concat(this.props.element.getFormId(),"[").concat(this.props.element.getFieldId(),"]"),className:"altrp-field-option__input ".concat(e?"active":""),onChange:this.onChange,checked:!!e,id:"".concat(this.props.element.getFormId(),"[").concat(this.props.element.getFieldId(),"]")})))}},{key:"renderRepeatedInput",value:function(){var e=this,t=this.state.options,n=void 0===t?[]:t,r=this.state.value,a=void 0===r?"":r,s=this.props.element.getFieldId()||Math.random().toString(36).substr(2,9),l=this.props.element.getFormId()||Math.random().toString(36).substr(2,9),i=this.props.element.getSettings("content_type","radio");return React.createElement("div",{className:"altrp-field-subgroup"},n.map((function(t,n){var r=!1;return"radio"===i?r=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.altrpCompare)(a,t.value,"=="):(a=_.isArray(a)?a:a?[a]:[],r=(0,_front_app_src_js_helpers__WEBPACK_IMPORTED_MODULE_4__.altrpCompare)(t.value,a,"in")),React.createElement("div",{className:"altrp-field-option ".concat(r?"active":""),key:"".concat(s,"-").concat(n)},React.createElement("span",{className:"altrp-field-option-span"},React.createElement("input",{type:i,value:t.value,name:"".concat(l,"-").concat(s),className:"altrp-field-option__input ".concat(r?"active":""),onChange:e.onChange,checked:r,id:"".concat(l,"-").concat(s,"-").concat(n)})),React.createElement("label",{htmlFor:"".concat(l,"-").concat(s,"-").concat(n),className:"altrp-field-option__label"},t.label))})))}},{key:"renderSelect2",value:function(){var e=this,t=this.props.element.getSettings(),n=t.content_options_nullable,r=t.nulled_option_title,a=t.content_placeholder,s=this.getOptions(),l=this.state.value;_.get(l,"dynamic")&&this.props.currentModel.getProperty("altrpModelUpdated")&&(l=this.getContent("content_default_value",!0)),l&&l.dynamic&&(l=""),this.props.element.getSettings("select2_multiple",!1)?(l=(l=l?_.isArray(l)?l:[l]:[]).map((function(e){var t=e;return s.forEach((function(e){e.value&&e.value.toString()===t.toString()&&(t=_objectSpread({},e)),_.isArray(e.options)&&e.options.forEach((function(e){e.value&&e.value.toString()===t.toString()&&(t=_objectSpread({},e))}))})),t}))).forEach((function(e){_.isObject(e)||s.push({value:e,label:e})})):s.forEach((function(e){e&&(e.value===l&&(l=_objectSpread({},e)),_.isArray(e.options)&&e.options.forEach((function(e){e.value==l&&(l=_objectSpread({},e))})))})),!n||"select2"===this.props.element.getSettings("content_type")&&!0===this.props.element.getSettings("select2_multiple")||(s=_.union([{label:r,value:"<null>"}],s));var i={className:"altrp-field-select2",onFocus:this.onFocus,element:this.props.element,classNamePrefix:this.props.element.getId()+" altrp-field-select2",options:s,name:this.props.element.getFieldId(),ref:this.altrpSelectRef,settings:this.props.element.getSettings(),onChange:this.onChange,onBlur:this.onBlur,value:l||_.find(s,(function(t){return t&&t.value==e.state.value})),isOptionSelected:function(t){return _.isNumber(e.state.value)||_.isString(e.state.value)?e.state.value==t.value:e.state.value&&e.state.value.includes(t.value)},placeholder:a,isMulti:this.props.element.getSettings("select2_multiple",!1),onKeyDown:this.handleEnter};return React.createElement("div",{className:"altrp-input-wrapper"},React.createElement(_admin_src_components_altrp_select_AltrpSelect__WEBPACK_IMPORTED_MODULE_6__.Z,i))}},{key:"renderWysiwyg",value:function(){return React.createElement(_ckeditor_CKeditor__WEBPACK_IMPORTED_MODULE_8__.Z,{onChange:this.onChange,onBlur:this.onBlur,changeText:this.dispatchFieldValueToStore,text:this.getContent("content_default_value"),name:this.getName(),readOnly:this.getContent("read_only")})}}]),InputWidget}(Component);__webpack_exports__.default=InputWidget}}]);
//# sourceMappingURL=2017.editor.js.map